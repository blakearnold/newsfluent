/*! updated; 05-16-2019 10:55 AM **/


Modulr.define("core.video:api",["require","jquery","lodash","helper","config","@fnc/embed/main","models/embeds","models/autoadvance","models/get.video","models/ais.auth","akamai.ver"],function(require,$,_,Helper,CONFIG){var VideoEmbed=require("@fnc/embed/main"),PageEmbeds=require("models/embeds"),AutoAdvance=require("models/autoadvance"),GetVideoFeed=require("models/get.video"),AISAuth=require("models/ais.auth"),AKAMAI_VERSION=require("akamai.ver"),PLAYLIST_STACK={},App=function(){var ret;(ret=!1,-1<(window.location.host||"").indexOf("aem-author")&&(ret=!0),ret)&&this.setAuthorMode()};return App.prototype.embed=function(target,opts){if(0===target.length)return Helper.log("Error: called video embed, no target!"),null;if(1!==target.length)return Helper.log("Error: multiple targets, loop through each one"),null;opts=_.isObject(opts)?_.cloneDeep(opts):{};var Instance=new VideoEmbed(target,opts);return Instance.set(),AutoAdvance(Instance),Instance},App.prototype.provider=function(type,target,opts,callback){require(["views/"+type+"/main"],function(App){new App(target,opts).set(callback)})},App.prototype.__iframe=function(type,opts,callback){require(["@fnc/iframe/main"],function(App){new App(type,opts).set(callback)})},App.prototype.getInfo=function(){return{build:"v"+AKAMAI_VERSION,embeds:PageEmbeds.getInfo()}},App.prototype.getQueryVar=function(val){return Helper.getQueryVar(val)},App.prototype.getVideoFeedById=function(){GetVideoFeed.apply(GetVideoFeed,arguments)},App.prototype.getPlaylistFeed=function(playlistId){var args=arguments,domain=null,callback=null;if("object"==typeof args[1]?(domain=args[1].domain||null,args[2]&&"function"==typeof args[2]&&(callback=args[2])):"function"==typeof args[1]&&(callback=args[1]),!(!playlistId||!callback))if(PLAYLIST_STACK[playlistId])callback(PLAYLIST_STACK[playlistId]);else{var url=Helper.getPlaylistFeedUrl(playlistId,{domain:domain||null});$.ajax({url:url,dataType:"json",cache:!0,data:{cb:Helper.cacheBuster()}}).done(function(data){var norm=function(data){var obj={},item=(obj.raw=data).channel.item;return item=Array.isArray(item)?item:[item],obj.items=item,obj}(data);PLAYLIST_STACK[playlistId]=norm,callback(norm)})}},App.prototype.translateConfig=function(legacy,conds){var config=_.cloneDeep(legacy);conds=conds||{};var arr,res={};return res.app={videoId:config.app.videoId,domain:config.app.domain,rules:(arr=[],config.player.autoplay&&!conds.playNext&&arr.push("autoplay"),config.player.autoadvance&&config.player.autoadvance.enabled&&arr.push("autoAdvance"),config.player.params&&config.player.params.playerName&&arr.push("playername:"+config.player.params.playerName),-1<window.location.search.indexOf("_noads=1")&&arr.push("noAds"),arr)},res.player=config.player,res},App.prototype.isAISAuthenticated=function(callback){"function"==typeof callback&&AISAuth.init(callback)},App.prototype.setAuthorMode=function(){CONFIG.authorMode=!0},new App});
Modulr.define("core.video:config",["require","jquery","cdn","akamai.ver","core.base:utils/environment","core.base:utils/cookie"],function(require,$){var qs,AKAMAI_BUNDLE_VERSION=require("akamai.ver"),IS_SSL=!!/https/.test(window.location.protocol),Env=require("core.base:utils/environment"),Cookie=require("core.base:utils/cookie"),config={};return config.cdn=require("cdn"),config.buildVer=Env.getCacheParam(),config.akamai={secure:IS_SSL,version:AKAMAI_BUNDLE_VERSION,feed:"/v/feed/video/${videoId}.js?template=fox",bundlePattern:"//foxnewsplayer-a.akamaihd.net/${envFolder}/${version}/amp.premier",configParam:{site:{foxnews:"fn",foxbusiness:"fb","live.foxbusiness":"fblive",insider:"insider",nation:"nation",radio:"radio"}}},config.videoDomain=["foxnews","foxbusiness","insider.foxnews"],config.optsDefault={player:{autoplay:!1,autoadvance:{enabled:!1,interval:5},ais:{redir:window.location.href},flash:{params:{wmode:"opaque"},vars:{share_enabled_providers:"facebook,twitter,linkedin"}}}},config.fncRadioId="5599024308001",config.eventPrefix="core.video.events",config.tve={foxnews:{videoId:"5614615980001",resourceID:"FoxNews"},foxbusiness:{videoId:"5614626175001",resourceID:"FoxBusiness"}},config.authenticated={foxnews:{resourceID:"FoxNews"},foxbusiness:{resourceID:"FoxBusiness"}},config.autoadvance={feed:"//${domain}/feeds/web/trending/video/all/feed/json",playlistId:{auto:"2366201037001",entertainment:"929831930001","food-drink":"932063991001",health:"930909749001",insider:"1039175296001",lifestyle:"931078438001",opinion:"940325740001",politics:"928378949001",radio:"931078426001",science:"1821663211001",sports:"930909752001",tech:"929831913001",travel:"1034196603001",us:"921261890001",world:"922779230001","americas-election-hq":"4728090022001","americans-newsroom":"903354961001","americas-news-hq":"926093635001","cavuto-live":"5679948655001","fox-and-friends":"930909787001","fox-files":"1794108334001","fox-friends-first":"1484128321001","fox-report-weekend":"930909795001","fox-news-night":"5588264677001","fox-news-sunday":"930909788001","geraldo-rivera-reports":"930909796001","greg-gutfeld-show":"4249245556001",hannity:"931078404001","happening-now":"930909808001","ingraham-angle":"5622526903001","journal-editorial-report":"930909810001","justice-jeanine":"937116552001","legends-lies":"4109346476001","life-liberty-levin":"5736530682001","media-buzz":"2636605067001","next-revolution-steve-hilton":"5452746184001",outnumbered:"3482905335001","outnumbered-overtime":"5588990584001","property-man":"4270654855001","shepard-smith":"2694949843001","special-report":"930909819001","sunday-morning-futures":"3386055101001","the-daily-briefing":"5588812415001","the-five":"1040983441001","the-story":"5410209611001","tucker-carlson-tonight":"5198073478001","war-stories":"932064054001","watters-world":"4607808626001","your-world-cavuto":"930909826001"}},config.ais={platformId:"urn:foxnews:com:sp:"+("qa"===config.cdn.env?"staging":"site")+":2"},config.heartbeatLive=["5369642345001"],config.authMode={type:(qs=window.location.search,function(){var id="_aismvpd";if(-1<qs.indexOf(id+"=0"))return Cookie(id,null),!1;var res=-1<qs.indexOf(id+"=1");return res?Cookie(id,"y",{path:"/",expires:null}):"y"===Cookie(id)&&(res=!0),res}()?"ais":"primetime")},config});
Modulr.define("core.video:helper",["require","jquery","config","core.base:utils/script.loader","core.plugins:URLInfo","jquery.cookie","core.base:utils/akamai"],function(require,$,config){var loadScript=require("core.base:utils/script.loader"),URLInfo=require("core.plugins:URLInfo"),Time=require("core.base:utils/akamai").time,cdn=config.cdn,Helper=function(){};return Helper.prototype.getCurrentTime=function(){return Time.getCurrent()},Helper.prototype.getEnv=function(){return cdn.env},Helper.prototype.getDomainId=function(){var hostname=window.location.hostname;return/foxbusiness\.com/.test(hostname)?"foxbusiness":/insider\.foxnews\.com/.test(hostname)?"insider.foxnews":"foxnews"},Helper.prototype.validateVideoId=function(id){return!/[^0-9]/g.test(id)},Helper.prototype.setEventName=function(name){return[config.eventPrefix,name].join("_")},Helper.prototype.loadScript=function(src,callback){if(src="string"==typeof src?[src]:src,$.isArray(src)){var trigger=function(){0<src.length?loadScript(src.shift(),function(){trigger()}):"function"==typeof callback&&callback()};trigger()}},Helper.prototype.enc=function(val){return encodeURIComponent(val)},Helper.prototype.dec=function(val){return decodeURIComponent(val)},Helper.prototype.log=function(){if(window.console){var args=Array.prototype.slice.call(arguments);args.unshift("[core.video]");try{return window.console.log.apply(window.console,args)}catch(err){window.console.log(args.join(" | "))}}},Helper.prototype.getQueryVar=function(name){var url=new URLInfo(window.location.href).getInfo(),res=url.query[name]||url.hash[name]||null;return null!==res&&"boolean"==typeof res&&(res=res.toString()),res},Helper.prototype.setUrlQuery=function(url,props){var info=new URLInfo(url).getInfo();for(var id in props){var val=props[id];info.query[id]?info.query[id]=val:info.hash[id]=val}return info},Helper.prototype.reEmbedIframe=function(instance,newOpts){var res=!1,currVideoId=instance._opts.app.videoId,currDomain=instance._opts.app.domain,isLegacy=instance._opts.app.legacy||!1,isTVE=this.isTVEVideoId(currVideoId),newIsTVE=this.isTVEVideoId(newOpts.app.videoId),newDomain=newOpts.app.domain||"foxnews";return isLegacy?res=!0:currVideoId!==config.fncRadioId&&newOpts.app.videoId===config.fncRadioId?res=!0:currVideoId===config.fncRadioId&&newOpts.app.videoId!==config.fncRadioId?res=!0:currDomain!==newDomain?res=!0:isTVE&&!newIsTVE||!isTVE&&newIsTVE?res=!0:isTVE&&newIsTVE&&currVideoId!==newOpts.app.videoId&&(res=!0),res},Helper.prototype.generateBundlePaths=function(ver,env,opts){var params,self=this,isTVE=opts.app.tve||!1,envFolder=(opts.app.auth,"prod"===env&&"qa"===config.cdn.env?"player":"qa"===config.cdn.env?"player/test":"player"),path=config.akamai.bundlePattern.replace("${version}",ver).replace("${envFolder}",envFolder),res={path:path,script:path+"/amp.premier"+("qa"===config.cdn.env?"":".min")+".js",conf:path+"/amp.foxnews.central.json?sec="+(config.akamai.secure?"1":"0")},queryParams=[];return function(){var site;if(isTVE){opts.app.videoId,config.tve.foxbusiness.videoId;var domainId=opts.app.videoId===config.tve.foxbusiness.videoId?"live.foxbusiness":"foxnews";site=config.akamai.configParam.site[domainId]}else site=opts.app.ampConfig&&opts.app.ampConfig.site?opts.app.ampConfig.site:-1<config.videoDomain.indexOf(opts.app.domain)?config.akamai.configParam.site[opts.app.domain]:config.akamai.configParam.site[self.getDomainId()];queryParams.push("site="+site)}(),params="notitle",opts.app.ampConfig&&"string"==typeof opts.app.ampConfig.params&&(params=[params,opts.app.ampConfig.params].join(",")),params=_.uniq(params.split(",")).join(","),queryParams.push("param="+params),opts.app.ampConfig&&opts.app.ampConfig.namespace&&queryParams.push("ns="+opts.app.ampConfig.namespace),opts.app.eumode&&queryParams.push("eu=1"),0<queryParams.length&&(res.conf=res.conf+"&"+queryParams.join("&")),res},Helper.prototype.cacheBuster=function(interval){interval=isNaN(interval)?(interval=Math.floor(parseInt(interval,10)))<2?2:59<interval?60:interval:2;var c=this.getCurrentTime(),mins=c.getMinutes(),ret=[c.getFullYear(),c.getMonth()+1,c.getDate(),c.getHours()].join("");return ret+=Math.floor(mins/interval)},Helper.prototype.setResponseTarget=function(resourceID,prefix){var redirect="FoxBusiness"===resourceID?"_fb":"_fn",popup="FoxBusiness"===resourceID?"_fb_winpopup":"_fn_winpopup";return{redirect:redirect=(prefix=prefix||"live")+redirect,popup:popup=prefix+popup}},Helper.prototype.isTVEVideoId=function(id){var res=!1;for(var i in config.tve)if(config.tve[i].videoId===id){res=!0;break}return res},Helper.prototype.setAISCookie=function(opts){var sp,val=opts&&opts.player&&opts.player.ais&&"string"==typeof opts.player.ais.redir?opts.player.ais.redir:null,expires=val?1:-1,cookieDomain="."+(sp=window.location.hostname.split(".")).slice(sp.length-2).join(".");$.cookie("FXN_v_idpp",val,{path:"/",domain:cookieDomain,expires:expires})},Helper.prototype.getHeight=function(width){return 9*Math.round(width/16)},Helper.prototype.getArticleBody=function(){var el=$("article div[itemprop='articleBody']");return 0===el.length&&(el=$("article .article-body")),el},Helper.prototype.getVideoFeedUrl=function(videoId,conf){var domain,res;return"//"+(domain=conf&&conf.domain?conf.domain:null,res="video.foxnews.com",domain&&/foxbusiness/i.test(domain)&&(res="video.foxbusiness.com"),res)+"/v/feed/video/"+videoId+".json?template=fox"},Helper.prototype.getPlaylistFeedUrl=function(playlistId,conf){var domain,res;return"//"+(domain=conf&&conf.domain?conf.domain:null,res="video.foxnews.com",domain&&/foxbusiness/i.test(domain)&&(res="video.foxbusiness.com"),"prod"!==cdn.env&&(res="beta."+res),res)+"/v/feed/playlist/"+playlistId+".json?template=fox"},Helper.prototype.isAuthorMode=function(){return config.authorMode||!1},new Helper});
Modulr.define("core.video:main",["require","jquery"],function(require,$){});
Modulr.define("core.video:models/ais.auth",["require","jquery","lodash","helper","config"],function(require,$,_,Helper,config){var EXECUTING=!1,CALLBACK_STACK=[],App=function(){};function processStack(data){for(var i=0;i<CALLBACK_STACK.length;i++)CALLBACK_STACK[i](data)}return App.prototype.init=function(callback){var url;CALLBACK_STACK.push(callback),EXECUTING||(EXECUTING=!0,url="//idp.securetve.com/rest/1.0/"+config.ais.platformId+"/init/?format=jsonp&responsefield=fxn_ais_idpInit",window.fxn_ais_idpInit=function(response){processStack(response),delete window.fxn_ais_idpInit,EXECUTING=!1},$.ajax({url:url,dataType:"script",cache:!0,error:function(jqXHR,textStatus,errorThrown){console.log("aisRequest > ERROR:",jqXHR,textStatus,errorThrown),processStack(null)}}))},new App});
Modulr.define("core.video:models/autoadvance",["require","jquery","lodash","helper","config","ISA"],function(require,$,_,Helper,config,ISA){var REQUEST_STACK={};return function(Instance){var opts=Instance.getOpts(),valid=!!(opts&&opts.player&&opts.player.autoadvance&&opts.player.autoadvance.enabled)&&(!opts.app.autoadvance||!(!opts.app.autoadvance||"custom"===opts.app.autoadvance)),playlistIdList=!!config.autoadvance.playlistId&&config.autoadvance.playlistId;if(valid){var url=config.autoadvance.feed.replace("${domain}",["www",opts&&opts.player&&/foxbusiness/i.test(opts.player.domain)?"foxbusiness":"foxnews","com"].join(".")),index=0,match=null,section="shows"===ISA._meta.section?ISA._meta.raw.subsection1:ISA._meta.section;for(var id in playlistIdList)if(playlistIdList[id]===section){match=playlistIdList[id];break}!function(url,playlistId,template){if(REQUEST_STACK[url])REQUEST_STACK[url].done?template(REQUEST_STACK[url].data):REQUEST_STACK[url].fn.push(template);else if(REQUEST_STACK[url]={data:null,fn:[template],done:!1},playlistId)REQUEST_STACK[url="//video.foxnews.com/v/feed/playlist/"+playlistId+".json?template=fox"]={data:null,fn:[template],done:!1},$.ajax({url:url,dataType:"json",cache:!0,success:function(data){var items=function(data){var arr=[];if(data&&data.channel&&data.channel.item)for(var items=data.channel.item,i=0;i<10;i++){var item=items[i],url=item.link;if(url){var videoId=(v=sp=ret=void 0,ret=null,sp=url.split("/v/")[1]||!1,(v=!!sp&&sp.split("/")[0])&&!isNaN(v)&&(ret=v),ret);videoId&&arr.push(videoId)}}var ret,sp,v;return arr}(data);REQUEST_STACK[url].data=items,REQUEST_STACK[url].done=!0,triggerStack(url)}});else{if(!url)return;$.ajax({url:url,dataType:"json",data:{cb:Helper.cacheBuster()},cache:!0,success:function(data){var items=function(data){var arr=[];if(data&&data.response&&data.response.docs)for(var items=data.response.docs,i=0;i<items.length;i++){var item=items[i],url=!!(item.url&&Array.isArray(item.url)&&item.url[0])&&item.url[0];if(url){var videoId=(v=sp=ret=void 0,ret=null,sp=url.split("/v/")[1]||!1,(v=!!sp&&sp.split("/")[0])&&!isNaN(v)&&(ret=v),ret);videoId&&arr.push(videoId)}}var ret,sp,v;return arr}(data);REQUEST_STACK[url].data=items,REQUEST_STACK[url].done=!0,triggerStack(url)}})}}(url,match,function(items){Instance.on("amp.advance",function(){var nextVideoId=items[index]||null;Helper.log("playing next video id:",nextVideoId),nextVideoId&&(Instance.change(nextVideoId,{player:{autoplay:!0}}),index++)})})}};function triggerStack(url){if(REQUEST_STACK[url])for(var data=REQUEST_STACK[url].data;0<REQUEST_STACK[url].fn.length;){REQUEST_STACK[url].fn.shift()(data)}}});
Modulr.define("core.video:models/embeds",["require","jquery","lodash","helper","config"],function(require,$,_,Helper,config){var VIDEO_EMBED_ITER=0,VIDEO_EMBED={},LAST_PLAY_UID=null,App=function(){};function stopOtherPlayers(uid){for(var id in VIDEO_EMBED){var item=VIDEO_EMBED[id];id!==uid&&item.instance&&(item.instance.pause(),item._playing=!1)}}function validateUID(uid){return!!/^fnc-embed-([0-9]+)/.test(uid)}return App.prototype.generateUID=function(){return"fnc-embed-"+ ++VIDEO_EMBED_ITER},App.prototype.initialize=function(uid,type){validateUID(uid)?VIDEO_EMBED[uid]||(VIDEO_EMBED[uid]={_initialized:!0,instance:null}):Helper.log("warning: invalid uid: "+uid)},App.prototype.store=function(uid,type,instance){validateUID(uid)?VIDEO_EMBED[uid].instance=instance:Helper.log("warning: invalid uid: "+uid)},App.prototype.setPlayState=function(uid,isPlaying){null===LAST_PLAY_UID?(VIDEO_EMBED[LAST_PLAY_UID=uid]._playing=isPlaying,stopOtherPlayers(uid)):isPlaying?LAST_PLAY_UID!==uid&&(VIDEO_EMBED[LAST_PLAY_UID=uid]._playing=!0,stopOtherPlayers(uid)):VIDEO_EMBED[uid]._playing=!1},App.prototype.getInfo=function(){var info={};for(var uid in VIDEO_EMBED)if(VIDEO_EMBED[uid].instance){var item=VIDEO_EMBED[uid].instance;info[uid]={target:item._target.get(0)}}return info},new App});
Modulr.define("core.video:models/get.video",["require","jquery","lodash","helper","config"],function(require,$,_,Helper,config){var FEED_STACK={};return function(){var args=arguments,domain=null,callback=null,videoId=args[0];if("object"==typeof args[1]?(domain=args[1].domain||null,args[2]&&"function"==typeof args[2]&&(callback=args[2])):"function"==typeof args[1]&&(callback=args[1]),!(!videoId||!callback))if(FEED_STACK[videoId])FEED_STACK[videoId].data?callback(FEED_STACK[videoId].data):FEED_STACK[videoId].stack.push(callback);else{FEED_STACK[videoId]={data:null,stack:[callback]};var url=Helper.getVideoFeedUrl(videoId,{domain:domain||null});$.ajax({url:url,dataType:"json",cache:!0}).done(function(data){var norm=function(data){var obj={},item=(obj.raw=data).channel.item;obj.image=item["media-group"]["media-thumbnail"]["@attributes"],obj.requires_auth=(restrict=item["media-restriction"],status=item["media-status"],res=!1,restrict&&"string"==typeof restrict&&"urn:protected"===restrict?res=!0:restrict&&"object"==typeof restrict&&restrict["@attributes"]?"deny"!==restrict["@attributes"].relationship&&"urn:protected"!==restrict["#text"]||(res=!0):status&&status["@attributes"]&&"blocked"===status["@attributes"].state&&(res=!0),res),obj.norm={},item["dc-date"]&&(obj.norm["dc-date"]=(val=item["dc-date"],sp=val.split("T"),date=sp[0],time=sp[1].split("-")[0],date=[(date=date.split("-"))[1],date[2],date[0]].join("/"),new Date([date,time].join(" "))));var val,sp,date,time;var restrict,status,res;return obj}(data);FEED_STACK[videoId].data=norm,function(videoId){if(0<FEED_STACK[videoId].stack.length)for(;0<FEED_STACK[videoId].stack.length;){var fn=FEED_STACK[videoId].stack.shift();fn(FEED_STACK[videoId].data)}}(videoId)})}}});
Modulr.define("core.video:models/is.authenticated",["require","jquery","lodash","helper","config","core.base:utils/localStorage","core.plugins:EventMessageHandler","models/get.video","models/mvpd"],function(require,$,_,Helper,config){var LocalStorage=require("core.base:utils/localStorage"),GetVideoFeed=require("models/get.video"),MVPD=(require("core.plugins:EventMessageHandler"),require("models/mvpd")),storeId="videoIsAuth",expiry=24,IS_MVPD="primetime"===config.authMode.type;function getStore(){var time,res=null,val=LocalStorage.get(storeId);if(val){var curr=JSON.parse(val);time=curr.expires,Helper.getCurrentTime().getTime()>parseInt(time,10)||curr.list.length<50&&(res=curr)}return res}return new function(){this.check=function(videoId,domain,callback){if(Helper.isTVEVideoId(videoId))done(!0,!0);else{var curr=getStore()||{};if(curr.list&&-1<curr.list.indexOf(""+videoId))return done(!!(curr.auth&&-1<curr.auth.indexOf(""+videoId)));GetVideoFeed(videoId,{domain:domain},function(data){var val,isAuth,bool;bool=data.requires_auth,isAuth=bool,void 0!==(val=videoId)&&LocalStorage.set(storeId,function(){val=""+val;var dt,curr=getStore();return curr?(-1===curr.list.indexOf(val)&&curr.list.push(val),isAuth&&curr.auth.push(val)):curr={list:[val],auth:isAuth?[val]:[],expires:(dt=Helper.getCurrentTime(),dt.getTime()+60*expiry*60*1e3)},JSON.stringify(curr)}()),done(bool,!1)})}function done(is_protected,is_tve){callback({requiresAuth:is_protected,tve:is_tve,mvpd:IS_MVPD})}},this.isUserAuthenticated=function(opts,callback,reset){MVPD.AuthN(opts,function(data){callback(data)},reset)},this.isUserAllowed=function(callback){MVPD.AuthZ(function(data){}),callback({authenticated:!0,allowed:!0})},this.authorization=function(opts,callback){callback()},this.logout=function(){MVPD.logout()},this.MVPD=MVPD}});
Modulr.define("core.video:models/mvpd",["require","jquery","lodash","helper","config","core.plugins:EventMessageHandler","core.base:utils/cookie"],function(require,$,_,Helper,config){var EventHandler=new(require("core.plugins:EventMessageHandler"));require("core.base:utils/cookie");return new function(){var Proto=this,XDCOMM_INITIALIZED=!1,CALLBACK_STACK=[],CHOOSER_LOADED=!1,LISTENERS={},XDCOMM_READY=!1,IFRAME_DOM=null,IFRAME_ID="fncmvpd-xdcomm";function onReady(callback){var src="https://"+config.cdn.hostname+"/mvpd/xdcomm.html?v="+config.buildVer,id=IFRAME_ID;if(XDCOMM_READY)return callback();CALLBACK_STACK.push(callback),XDCOMM_INITIALIZED||(XDCOMM_INITIALIZED=!0,EventHandler.addHandler(setName("mvpd_iframe_ready_xdcomm"),function(data){IFRAME_DOM.attr("data-ifr-ready","1"),XDCOMM_READY||(execCallStack(CALLBACK_STACK,!0),XDCOMM_READY=!0)}),EventHandler.addHandler(setName("mvpd_id_val"),function(data){var val;val=data&&data.mvpdId?data.mvpdId:null,window.leapmetrics=window.leapmetrics||[],window.leapmetrics.push(function(Leap){"function"==typeof Leap.cookieProps&&(Helper.log("setting mvpdId.."),Leap.cookieProps("set",{mvpdId:val}))})})),0===$("#"+id).length&&($("body").append('<iframe id="'+id+'" src="'+src+'" border="0" frameborder="0" scrolling="no" style="width: 0; height: 0; visibility: hidden;"></iframe>'),IFRAME_DOM=$("#"+id))}function send(name,data){onReady(function(){EventHandler.sendMessage(IFRAME_DOM.get(0),setName(name),data||null)})}function listen(name,callback,sender){var eventId=setName(name);LISTENERS[name]?LISTENERS[name].push(callback):(LISTENERS[name]=[callback],EventHandler.addHandler(eventId,function(data){execCallStack(LISTENERS[name],data)})),sender&&send(name,!0),XDCOMM_INITIALIZED||onReady(function(){})}function setName(val){return"_fnc_mvpd_"+val}function execCallStack(arr,data){for(;0<arr.length;)arr.shift()(data)}Proto.AuthN=function(opts,callback,reset){XDCOMM_INITIALIZED=XDCOMM_READY=!1,$("#"+IFRAME_ID).remove(),listen("user_logged_in",function(){window.location.reload()}),listen("user_logged_out",function(){window.location.reload()}),listen("user_authenticated",function(data){var info;(data=data||{}).chooserAction?window.location.reload():(info={raw:data},_.merge(info,{resourceId:data.resourceId||null,authenticated:!!data.auth||!!data.token,authorized:!!data.token||!!data.authorized,token:data.token||null,ttl:data.ttl||null,providerInfo:data.providerInfo||null,iframe:"https://"+config.cdn.hostname+"/mvpd/index.html?v="+config.buildVer}),info.poweredLogo=function(item){if(!item)return null;var res=item.logo;if("object"==typeof item.logoList){var found=!1;for(var id in item.logoList){var logo=item.logoList[id];if(/mvpd\/powered\/(.+)\.(jpg|jpeg|gif|png|svg)$/.test(logo)){res=logo,found=!0;break}}res=found?res:item.logoList.large_black||res}return res}(info.providerInfo),callback(info))}),listen("user_authorized_comcast",function(data){CHOOSER_LOADED&&data&&data.flag&&window.location.reload()}),send("mvpd_iframe_init_xdcomm",Proto.getInfo(opts))},Proto.AuthZ=function(callback){listen("authz",function(data){callback(data)},!0),callback({authenticated:!0,allowed:!0})},Proto.authToken=function(opts,callback){callback()},Proto.logout=function(){0<$("#"+IFRAME_ID).length&&send("logout",{type:"logout"})},Proto.getInfo=function(opts){return{domain:opts.app.domain||"foxnews",referrer:(host=window.location.host,/foxbusiness/.test(host)?"foxbusiness":"foxnews"),sender:window.location.href};var host},Proto.setChooserMode=function(){CHOOSER_LOADED=!0},Proto.showOverlay=function(target,info){var providerName=info&&info.providerInfo&&info.providerInfo.name?info.providerInfo.name:"provider",providerLogo=info&&info.providerInfo&&info.providerInfo.logoList&&info.providerInfo.logoList.large_white?info.providerInfo.logoList.large_white:null,markup='<div class="unauthorized-mvpd"><p>Sorry, your '+providerName+" account is not authorized to view this content.</p></div>";providerLogo&&(markup=$(markup).css("background-image",'url("'+providerLogo+'")')),target.html(markup)},Proto.listen=listen}});
Modulr.define("core.video:models/new.relic",["require","jquery","lodash","helper","config","ISA","akamai.ver"],function(require,$,_,Helper,config,ISA){var Provider=ISA.provider("new-relic"),CoreTracker=ISA.provider("coreTracker"),ENV=Helper.getEnv(),AKAMAI_BUNDLE_VERSION=require("akamai.ver");return function(VIDEO_ID){var VIDEO_DOMAIN=/foxbusiness/.test(window.location.host)?"foxbusiness":"foxnews",AD_BLOCK_STATUS=CoreTracker.isEnabled(),BUILD_VERSION=Modulr.getGlobalCacheParam();this.set=function(){Provider.setCustomAttributes({"fnc.video.iframe.AD_BLOCK":AD_BLOCK_STATUS,"fnc.video.iframe.ENV":ENV,"fnc.video.iframe.VIDEO_DOMAIN":VIDEO_DOMAIN,"fnc.video.iframe.VIDEO_ID":VIDEO_ID,"fnc.video.iframe.FRONTEND_BUILD_VERSION":BUILD_VERSION,"fnc.video.iframe.AMP_VERSION":AKAMAI_BUNDLE_VERSION}),"function"==typeof window.newrelic.setErrorHandler&&(window.newrelic.setErrorHandler(function(err){return Provider.setCustomPageAction({JSErrorEvent:{"fnc.video.iframe.error.ERR_TYPE":err.name,"fnc.video.iframe.error.ERR_MESSAGE":err.message,"fnc.video.iframe.error.STACK_TRACE":err.stack,"fnc.video.iframe.error.AD_BLOCK_STATUS":AD_BLOCK_STATUS,"fnc.video.iframe.error.PLAYER_VERSION:":version,"fnc.video.iframe.error.FRONTEND_BUILD_VERSION":BUILD_VERSION}}),!1}),Helper.log("NR listener ready!"))}}});
Modulr.define("core.video:models/overlay",["require","jquery","lodash","helper","config","models/get.video","core.plugins:ImageResizer"],function(require,$,_,Helper,config){var GetVideoFeed=require("models/get.video"),Resizer=require("core.plugins:ImageResizer");return function(target,videoId,domain){this.set=function(trigger){GetVideoFeed(videoId,{domain:domain},function(data){var src=data&&data.image&&data.image.url?data.image.url:null;if(src){var markup='<div class="m video-ct">                            <a href="#"><picture>                            <source media="(max-width: 767px)" srcset="'+Resizer(src,348,196)+'">                            <source media="(min-width: 768px)" srcset="'+Resizer(src,768,432)+'">                            <img src="'+src+'" alt="image name">                        </picture>                        <span class="overlay">Video</span></a>                        </div>';target.html(markup),target.find("a").on("click",function(evt){return evt.preventDefault(),trigger(),!1})}else trigger();console.log("data",data)}),console.log("todo: //"),trigger()}}});
Modulr.define("core.video:models/tracking",["require","jquery","helper","ISA"],function(require,$,Helper){var LEAP_INSTANCE=null,loaded=!1;Load(function(Leap){LEAP_INSTANCE=Leap});var App=function(uid,opts){window.leapmetrics;this.track=function(data,callback){console.log("tracking todo >>>>>>",data)},this.getPageInfo=function(callback){Load(function(Leap){var data={};Leap&&"function"==typeof Leap.pageInfo&&(data=Leap.pageInfo()),callback({page:data.page||{},properties:data.properties||{},options:data.options||{}})})}};function Load(callback){if(loaded)callback(LEAP_INSTANCE);else{var timeout=setTimeout(function(){loaded?callback(LEAP_INSTANCE):(Helper.log("Leap Metrics timed out!"),loaded=!0,callback(null))},3e3);window.leapmetrics=window.leapmetrics||[],window.leapmetrics.push(function(Leap){clearTimeout(timeout),loaded||(loaded=!0),callback(Leap)})}}return{create:function(uid,opts){return new App(opts)}}});
Modulr.define("core.video:views/fox-news/embed/events",["require","jquery","lodash","helper","config"],function(require,$,_,Helper,config){var App=function(uid,IframeListener){this._UID=uid,this._IframeListener=IframeListener;var EVENT_STACK={};this._listenFor=function(name,callback){EVENT_STACK[name]||(EVENT_STACK[name]=[]),EVENT_STACK[name].push(callback)},this._IframeListener.listen(function(event){var name=event.name,data=event.data;if(EVENT_STACK[name])for(var i=0;i<EVENT_STACK[name].length;i++)EVENT_STACK[name][i](data)}),this._listenFor("amp.auth.reloadParentPage",function(){window.location.reload()})};return App.prototype.play=function(callback){var event=this._IframeListener;this._listenFor("amp.play",function(){"function"==typeof callback&&callback()}),event.send("play")},App.prototype.pause=function(callback){var event=this._IframeListener;"function"==typeof callback&&this._listenFor("amp.pause",callback),event.send("pause")},App.prototype.pauseState=function(callback){var event=this._IframeListener;"function"==typeof callback&&this._listenFor("player.pauseState",callback),event.send("pauseState")},App.prototype.mute=function(callback){var event=this._IframeListener;"function"==typeof callback&&this._listenFor("player.mute",callback),event.send("mute")},App.prototype.unmute=function(callback){var event=this._IframeListener;"function"==typeof callback&&this._listenFor("player.unmute",callback),event.send("unmute")},App.prototype.volume=function(callback){var event=this._IframeListener;"function"==typeof callback&&this._listenFor("player.volume",callback),event.send("volume")},App.prototype.volumeSet=function(callback,val){if("number"!=typeof val)callback(null);else{var event=this._IframeListener;"function"==typeof callback&&this._listenFor("player.volume.set",callback),event.send("volumeSet",{val:val})}},App.prototype.muteState=function(callback){var event=this._IframeListener;"function"==typeof callback&&this._listenFor("player.muteState",callback),event.send("muteState")},App.prototype.jump=function(callback,val){var event=this._IframeListener;"function"==typeof callback&&this._listenFor("player.jump",callback),event.send("jump",val)},App.prototype.logout=function(callback){this._IframeListener.send("logout")},App.prototype.pageFlag=function(callback,val){var event=this._IframeListener;"function"==typeof callback&&this._listenFor("player.pageFlag",callback),event.send("pageFlag",{val:val})},App});
Modulr.define("core.video:views/fox-news/embed/isa",["require","jquery","lodash","helper","config","ISA"],function(require,$,_,Helper,config,ISA){return function(mainCallback){if("function"==typeof mainCallback){window.FNC.ISA.provider("omni"),window.FNC.ISA.provider("krux");var provider,success,omtrInterface=(provider=window.FNC.ISA.provider("omni"),success=!1,function(callback){provider?(provider.onExtInterfaceReady(function(omtrVals){success||(success=!0,callback(omtrVals))}),setTimeout(function(){success||(success=!0,Helper.log("warning: omniture did not return after 5 seconds!"),callback(null))},5e3)):callback()}),kruxInterface=function(provider){var success=!1;return function(callback){provider?(provider.get(function(){success||(success=!0,callback({ksg:provider.getVal("segments"),kuid:provider.getVal("user")}))}),setTimeout(function(){success||(success=!0,Helper.log("[video.renderer] warning: krux did not return after 5 seconds!"),callback(null))},5e3)):callback()}}(window.FNC.ISA.provider("krux"));omtrInterface(function(omtrVals){kruxInterface(function(kruxVals){mainCallback({omtr:omtrVals,krux:kruxVals})})})}}});
Modulr.define("core.video:views/fox-news/embed/main",["require","jquery","helper","config","models/embeds","models/is.authenticated","models/overlay","models/tracking","@fnc/embed/events","@fnc/embed/isa","@fnc/rules","@fnc/listener","ISA","cache.param","core.plugins:EventMessageHandler"],function(require,$,Helper,config){var EventListener=require("@fnc/listener"),Events=require("@fnc/embed/events"),ISAInterface=require("@fnc/embed/isa"),Rules=require("@fnc/rules"),PageEmbed=require("models/embeds"),CacheParam=require("cache.param"),Overlay=require("models/overlay"),Authentication=require("models/is.authenticated"),EventHandler=require("core.plugins:EventMessageHandler"),Tracking=require("models/tracking"),ENV=Helper.getEnv(),ISA=require("ISA"),VIDEO_UID_ATTR="data-video-id",VIDEO_DOMAIN_ATTR="data-video-domain",App=function(target,opts){var uid,res;this._UID=PageEmbed.generateUID(),this._target=target||[],this._Tracking=Tracking.create(this._UID,opts),this._opts=(uid=this._UID,res=_.cloneDeep(config.optsDefault),res=_.merge(res,_.cloneDeep(opts)),res=_.merge(res,{app:{uid:uid}})),Rules.setApp(this._opts),this._PLAYER_READY=!1,this._INITIALIZED=!1,this._IframeListener=EventListener.create(this._target,this._UID,"embed"),this._Events=new Events(this._UID,this._IframeListener),this._EVENT_STACK={},this._LISTENER_INIT=!1,PageEmbed.initialize(this._UID,"fox-news"),this.__getOpts=function(){return this._opts}};function triggerEventStack(stack,data){for(var i=0;i<stack.length;i++)stack[i](data)}function getAttr(target){var videoId=target.attr(VIDEO_UID_ATTR)||null,domain=target.attr(VIDEO_DOMAIN_ATTR)||Helper.getDomainId();return{videoId:videoId=Helper.validateVideoId(videoId)?videoId:null,domain:domain=-1===config.videoDomain.indexOf(domain)?null:domain}}function changeVideo(self,videoId,newOpts,forceReEmbed){self._target.attr(VIDEO_UID_ATTR,videoId);var attr=getAttr(self._target);function reEmbed(){Helper.log("[embed] re-embedding iframe..");var currOpts=_.cloneDeep(self._opts);if(config.fncRadioId===videoId?Rules.set("fncRadio",newOpts):newOpts.app.domain||(newOpts.app.domain="foxnews"),!_.isEmpty(currOpts.app.ampConfig))for(var id in _.isEmpty(newOpts.app.ampConfig)&&(newOpts.app.ampConfig={site:config.akamai.configParam.site[newOpts.app.domain]||null}),currOpts.app.ampConfig)newOpts.app.ampConfig[id]||(newOpts.app.ampConfig=currOpts.ampConfig);currOpts.app.domain!==newOpts.app.domain&&self._target.attr(VIDEO_DOMAIN_ATTR,newOpts.app.domain),self._opts.player={},self._opts.app.omtrVals={},_.merge(self._opts,newOpts),Rules.setApp(self._opts),self._PLAYER_READY=!1,self._INITIALIZED=!1,self.set(null,!0)}forceReEmbed?reEmbed():Helper.reEmbedIframe(self,newOpts)?reEmbed():Authentication.check(videoId,newOpts.app.domain||attr.domain||null,function(bool){bool?reEmbed():self._IframeListener.send("__change",{videoId:videoId,opts:newOpts})})}return App.prototype.on=function(event,callback){"string"==typeof event&&"function"==typeof callback&&(this._EVENT_STACK[event]||(this._EVENT_STACK[event]=[]),this._EVENT_STACK[event].push(callback))},App.prototype.trigger=function(){var self=this,args=arguments,event=args[0],props=null,callback=null;function exec(){self._Events[event](callback,props)}"function"==typeof args[1]?callback=args[1]:("function"!=typeof args[1]&&(props=args[1]),"function"==typeof args[2]&&(callback=args[2])),self._Events[event]&&(self.isReady()?exec():self.on("player.ready",function(){exec()}))},App.prototype.isReady=function(){return!!this._PLAYER_READY},App.prototype.getOpts=function(){return this.__getOpts()},App.prototype.pause=function(){this.trigger("pause")},App.prototype.play=function(){this.trigger("play")},App.prototype.logout=function(){Authentication.logout()},App.prototype.change=function(videoId,newOpts){var res,self=this;Helper.validateVideoId(videoId)?videoId!==this._target.attr(VIDEO_UID_ATTR)&&(res=_.cloneDeep(config.optsDefault),_.isObject(newOpts)&&_.merge(res,newOpts),newOpts=res,_.merge(newOpts,{app:{videoId:videoId}}),this._FORCE_RE_EMBED?(this._FORCE_RE_EMBED=!1,changeVideo(this,videoId,newOpts,!0)):this._PLAYER_READY?changeVideo(this,videoId,newOpts):(this._LISTENER_INIT||setTimeout(function(){self._LISTENER_INIT||(delete self._EVENT_STACK.__change,changeVideo(self,videoId,newOpts,!0))},3e3),this._EVENT_STACK.__change={videoId:videoId,opts:newOpts})):Helper.log("[change] invalid videoId:",videoId)},App.prototype.set=function(callback,RE_EMBED){if(!this._INITIALIZED){this._INITIALIZED=!0;var self=this,IframeListener=this._IframeListener,attr=getAttr(this._target),validation=function(target,opts,attr){var res=!0,errors=[];0===target.length?(res=!1,errors.push("target not found")):attr.videoId||opts.app.videoId||(errors.push("missing videoId"),res=!1);return{valid:res,errors:errors}}(this._target,this._opts,attr);if(callback="function"==typeof callback?callback:function(){},validation.valid){var target=this._target,opts=this._opts,EMBED_UID=this._UID,VIDEO_ID=opts.app.videoId||attr.videoId,VIDEO_DOMAIN=opts.app.domain||attr.domain,IFRAME_MARKUP='<iframe src="${src}" border="0" frameborder="0" allow="autoplay" scrolling="no" style="width: 100%; height: 1px; min-height: 100%;" mozallowfullscreen webkitallowfullscreen allowfullscreen></iframe>';Authentication.check(VIDEO_ID,VIDEO_DOMAIN,function(info){info.requiresAuth&&info.mvpd?Authentication.isUserAuthenticated(opts,function(authNInfo){var stack;_.merge(info,{authNInfo:authNInfo}),(stack=self._EVENT_STACK["mvpd.authentication"]||[])&&triggerEventStack(stack,authNInfo),authNInfo.authenticated?authNInfo.authorized?cont(info):(self._FORCE_RE_EMBED=!0,target.empty(),function(stack){Array.isArray(stack)&&0<stack.length?triggerEventStack(stack,authNInfo):Authentication.MVPD.showOverlay(target,authNInfo)}(self._EVENT_STACK["mvpd.unauthorized"]||[])):function(info,opts){var Chooser=new EventHandler;Chooser.addHandler(setName("mvpd_iframe_ready_chooser"),function(data){Authentication.MVPD.setChooserMode(),Chooser.sendMessage($("#mvpd-picker").get(0),setName("mvpd_iframe_init_chooser"),Authentication.MVPD.getInfo(opts))}),target.empty();var markup=function(markup){var el=$(markup);return/iframe/i.test(el.get(0).tagName)?el.attr("id","mvpd-picker"):el.find("iframe:first").attr("id","mvpd-picker"),el}(getIframeMarkup(info.authNInfo.iframe));function setName(val){return"_fnc_mvpd_"+val}target.append(markup)}(info,opts)},RE_EMBED):cont(info)})}else callback(validation,null)}function cont(info){var obj,IS_PROTECTED=info.requiresAuth,IS_TVE=info.tve,IS_MVPD=info.mvpd;IS_PROTECTED&&(IS_TVE&&_.merge(opts,{app:{tve:!0}}),_.merge(opts,{app:{auth:{enabled:!0,domain:VIDEO_DOMAIN,mvpd:IS_MVPD?info.authNInfo:null}}}),IS_MVPD?_.merge(opts.player,{ais:{enabled:!1}}):Rules.set("setAIS",opts)),target.attr(((obj={})["data-embed-uid"]=EMBED_UID,obj[VIDEO_UID_ATTR]=VIDEO_ID,obj));var trigger=function(){opts.app.env;var arr,src="//"+("qa"===ENV?"dev-":"staging"===ENV?"stage-":"")+"static.foxnews.com/static/orion/html/video/iframe/"+(IS_PROTECTED?"tve":"vod")+".html?v="+CacheParam,params=((arr=[]).push("uid="+Helper.enc(EMBED_UID)),arr.join("&"));if(_.merge(opts,{app:{videoId:VIDEO_ID,domain:VIDEO_DOMAIN}}),ISA.eu.enabled()&&ISA.eu.check()&&(_.merge(opts,{app:{eumode:!0}}),Rules.set("noAds",opts)),Helper.isAuthorMode()&&Rules.set("noAutoplay",opts),window.AamGpt&&"function"==typeof window.AamGpt.getCookie){var aam=AamGpt.getCookie("fngpt")||!1;aam&&(aam=1<(aam=aam.split("=")).length?aam[1]:aam[0],_.merge(opts,{player:{params:{aam:aam}}}));var aamId=AamGpt.getCookie("aam_did")||!1;aamId&&(aamId=1<(aamId=aamId.split("=")).length?aamId[1]:aamId[0],_.merge(opts,{player:{params:{aamId:aamId}}}))}self._LISTENER_INIT||(self._LISTENER_INIT=!0,IframeListener.listen(function(event){var name=event.name,data=event.data;switch(name){case"iframe.ready":IframeListener.send("__load",self.__getOpts());break;case"player.ready.init":if(self._PLAYER_READY=!0,self._opts=_.merge(self._opts,data.opts),"function"==typeof callback&&callback(self),PageEmbed.store(EMBED_UID,"fox-news",self),self._EVENT_STACK.__change){var change=_.cloneDeep(self._EVENT_STACK.__change);try{delete self._EVENT_STACK.__change}catch(err){self._EVENT_STACK.__change=null}changeVideo(self,change.videoId,change.opts)}break;case"amp.play":case"amp.ads.started":case"amp.ads.play":PageEmbed.setPlayState(EMBED_UID,!0);break;case"amp.pause":PageEmbed.setPlayState(EMBED_UID,!1);break;case"amp.sharepanel.share":opts.app.noShare||function(data){require(["core.plugins:Sharing"],function(Sharing){switch(data.provider){case"facebook":Sharing.facebook(data.url);break;case"twitter":Sharing.twitter({url:data.url,title:data.title});break;case"embed":break;case"email":var params=[];params.push("subject="+Helper.enc(data.title)),params.push("body=Video link:"+Helper.enc(data.url)),window.open("mailto:?"+params.join("&"),"_self")}})}(data);break;case"metrics.track.event":self._Tracking.track(data)}"player.ready.init"===name&&(name="player.ready",data={videoId:VIDEO_ID,uid:EMBED_UID,domain:opts.app.domain,bundleVersion:data.bundleVersion}),self._EVENT_STACK[name]&&triggerEventStack(self._EVENT_STACK[name],data)}));var triggerFrame,markup=getIframeMarkup([src,params].join("#"));triggerFrame=function(vals){vals=vals||{};self._Tracking.getPageInfo(function(pageInfo){Helper.log("Metrics PageInfo:",pageInfo),_.merge(opts,{app:{leapPageInfo:pageInfo}}),vals.omtr&&_.merge(opts,{app:{omtrVals:vals.omtr}}),vals.krux&&_.merge(opts,{app:{kruxVals:vals.krux}}),target.empty(),target.html(markup)})},ISA?ISAInterface(function(info){triggerFrame(info)}):triggerFrame(null)};!function(){if(opts.app.overlay&&opts.app.overlay.enabled){var item=_.cloneDeep(opts.app.overlay);if(Rules.set("autoplay",opts),"function"==typeof item.event){item.event(function(){trigger()});try{delete opts.app.overlay.event}catch(err){opts.app.overlay.event=null}}else{new Overlay(target,VIDEO_ID,VIDEO_DOMAIN).set(function(){trigger()})}}else trigger()}()}function getIframeMarkup(src,props){var markup=IFRAME_MARKUP.replace("${src}",src),currentdomain=location.hostname;return target.hasClass("video-container")||-1!==currentdomain.indexOf("video.fox")||(markup='<div class="video-container">'+markup+"</div>"),markup}},App});
Modulr.define("core.video:views/fox-news/embed/migrate",["require","jquery","lodash","helper","config"],function(require,$,_,Helper,config){return function(Instance,opts,legacy){return legacy=_.cloneDeep(legacy),opts}});
Modulr.define("core.video:views/fox-news/embed/uid",["require","jquery","lodash","helper","config"],function(require,$,_,Helper,config){var VIDEO_EMBED_ITER=0;return function(){return"fox-video-embed-"+ ++VIDEO_EMBED_ITER}});
Modulr.define("core.video:views/fox-news/event.handler",["require","core.plugins:EventMessageHandler"],function(require){var EventHandler=require("core.plugins:EventMessageHandler");return function(target,uid,type,namePrefix){type=type||"generic",namePrefix=namePrefix||"generic.events";var Handler=new EventHandler,messageId=namePrefix+uid,LISTENER_STACK=[];Handler.addHandler(messageId,function(data){for(var i=0;i<LISTENER_STACK.length;i++)LISTENER_STACK[i](data)});this.listen=function(callback){"function"==typeof callback&&LISTENER_STACK.push(callback)},this.send=function(name,data){if(name){var obj={uid:"uid-embed-"+uid,name:name,data:void 0===data?null:data},messageId=namePrefix+uid,dom="string"==typeof target&&"parent"===target?"parent":target.find("iframe:first").get(0);Handler.sendMessage(dom,messageId,obj)}}}});
Modulr.define("core.video:views/fox-news/iframe/amp.events",["require","jquery","helper","config","core.plugins:OnWindowResize","core.plugins:EventMessageHandler"],function(require,$,Helper,config,akamai){var OnWindowResize=require("core.plugins:OnWindowResize"),FrameEvents=new(require("core.plugins:EventMessageHandler")),_overlay_center=!1;return function(amp,EventListener,opts,callback){var RELOAD_TRIGGERED,authHandler,trigger,send=function(name,data){EventListener.send(name,"object"==typeof data&&data.data||data||!0)};if(opts.player&&opts.player.getPlaybackOrder){opts.player.getPlaybackOrder=null;try{delete opts.player.getPlaybackOrder}catch(err){}}if(amp.ads&&(amp.ads.addEventListener("companion",function(data){send("amp.ads.companion",{data:{companions:!!(data&&data.data&&data.data.companions)&&data.data.companions}})}),amp.ads.addEventListener("started",function(data){send("amp.ads.started",data)}),amp.ads.addEventListener("ended",function(data){send("amp.ads.ended",data)}),amp.ads.addEventListener("error",function(){amp.evaluateBindings("#{window.createShowPersonality(media.category)}"),amp.evaluateBindings("#{window.createShowCategory(media.category)}"),amp.evaluateBindings("#{window.createShowName(media.category)}"),amp.evaluateBindings("#{window.createShowSection(media.category)}"),Helper.log("[amp.ads.error] An error has been generated:",arguments)}),amp.ads.addEventListener("play",function(data){send("amp.ads.play",data)}),amp.ads.addEventListener("pause",function(data){send("amp.ads.pause",data)})),amp.auth&&(RELOAD_TRIGGERED=!1,authHandler=function(name,event){if(!event)return Helper.log("No authentication event data!"),!1;var isAuthorization=!(!event||!event.data||"boolean"!=typeof event.data.authorization),authConfig=!!(event&&event.target&&event.target.config)&&event.target.config,authData={resource:authConfig.resourceID,platform_id:authConfig.platformID};isAuthorization&&(authData.authorization=event.data.authorization);var info={name:name,data:{type:isAuthorization?"authorization":"authentication",data:event.data,auth:authData,videoId:opts&&opts.app&&opts.app.videoId?opts.app.videoId:null}};Helper.log("Authentication Handler:",name,info),send("amp.auth.handler",info)},amp.auth.addEventListener("authorizationfailed",function(data){authHandler("authorizationfailed",data)}),amp.auth.addEventListener("authenticated",function(data){authHandler("authenticated",data)}),amp.auth.addEventListener("launchidplogin",function(data){Helper.setAISCookie(opts),$(window).bind("beforeunload",function(){RELOAD_TRIGGERED||(RELOAD_TRIGGERED=!0)})})),amp.autoadvance&&amp.autoadvance.addEventListener("advance",function(data){send("amp.advance",data)}),amp.recommendations&&amp.recommendations.addEventListener("selected",function(data){send("amp.recommendations",data)}),"function"==typeof window.enableLiveAds){var oncanplaythrough=function(){amp.removeEventListener("canplaythrough",oncanplaythrough),enableLiveAds(amp)};amp.addEventListener("canplaythrough",oncanplaythrough)}function sendVideoInfo(type,data){send("info.change",{data:{type:type,info:data},opts:opts})}amp.addEventListener("mediachange",function(data){send("amp.mediachange",{amp:data.data,opts:opts}),sendVideoInfo("mediachange",data.data)}),amp.addEventListener("play",function(data){send("amp.play",{amp:data.data,opts:opts})}),amp.addEventListener("ended",function(data){send("amp.ended",{amp:data.data,opts:opts})}),amp.addEventListener("pause",function(data){send("amp.pause",{amp:data.data,opts:opts})}),trigger=function(data){var res,shareData=data.data||data,feedData=amp.feed.getData(),customShareURL=Helper.getQueryVar("shareUrl")||!1,customShareTitle=Helper.getQueryVar("shareTitle")||!1,url=customShareURL||shareData.link.replace(/beta\./,""),title=(res="",customShareTitle?res=$("<span></span>").html(customShareTitle).text():feedData.channel&&feedData.channel.item&&feedData.channel.item.title&&(res=feedData.channel.item.title),res),info={videoId:feedData.channel&&feedData.channel.item&&feedData.channel.item.guid?feedData.channel.item.guid:null,provider:"string"==typeof shareData.provider?shareData.provider:"object"==typeof shareData.provider&&shareData.provider.id?shareData.provider.id:null,url:url,title:title};"share"!==info.provider&&("embed"===info.provider?function(info){var body=$("body"),embed=body.find("> .share-panel.embed");0===embed.length&&($("body").prepend('<div class="share-panel embed">                <h1>Embed</h1>                <a href="#" title="Close">Close</a>                <textarea>Embed code inserted here</textarea>            </div>'),(embed=body.find("> .share-panel.embed")).find("textarea").unbind("focus").bind("focus",function(){var elm=$(this);elm.select(),elm.bind("mouseup",function(){return elm.unbind("mouseup"),!1})}),embed.find("> a:first").unbind("click").bind("click",function(evt){return evt.preventDefault(),embed.removeClass("show"),!1}),_overlay_center||function(target,force){var listener=!1,body=$("body"),win=$(window),overlayW=target.outerWidth(),overlayH=target.outerHeight(),px=function(val){return val+"px"},topScroll=function(){var w=win.height(),s=win.scrollTop(),h=overlayH;return h=Math.floor(w/2-h/2),s+(h<0?0:h)},leftScroll=function(){var l=body.offset().left,w=body.width();return w=Math.floor(w/2-overlayW/2),l+w};force&&target.css({top:px(topScroll()),left:leftScroll()}),window,OnWindowResize(function(){clearTimeout(listener),listener=setTimeout(function(){target.animate({top:px(topScroll()),left:leftScroll()},150,"swing")},150)})}(embed,_overlay_center=!0));var textarea=embed.find("textarea"),domain=/foxbusiness\.com/.test(window.location.hostname)?"video.foxbusiness.com":"video.foxnews.com",siteLink=-1<domain.indexOf("video.foxbusiness")?"foxbusiness.com":"foxnews.com",protocol=window.location.protocol,videoId=info.videoId,code='<script type="text/javascript" src="'+protocol+"//"+domain+"/v/embed.js?id="+videoId+'&w=466&h=263"><\/script><noscript>Watch the latest video at <a href="'+protocol+"//www."+siteLink+'">'+siteLink+"</a></noscript>";textarea.val(code),embed.addClass("show")}(info):(window.leapmetrics=window.leapmetrics||[],window.leapmetrics.push(function(Leap){Leap.track("share",{page_content_shared:info.url,page_share_method:info.provider}).then(function(){})}),send("amp.sharepanel.share",info)))},amp.sharepanel?amp.sharepanel.addEventListener("share",trigger):amp.addEventListener("share",trigger),amp.feed&&amp.feed.addEventListener("loaded",function(data){send("amp.feed.loaded",{feed:data.data,opts:opts}),sendVideoInfo("feed.loaded",data.data)}),function(name,callback){FrameEvents.addHandler(name,function(){callback.apply(callback,arguments)})}("ais-popup.page-reload",function(){send("amp.auth.reloadParentPage")})}});
Modulr.define("core.video:views/fox-news/iframe/amp.functions",["require","jquery","helper","config"],function(require,$,Helper,config){function createCategoryString(categories,tag){var items=[];categories=categories||[];for(var i=0;i<categories.length;i++){var item=categories[i];if(startsWith(item,tag)){var cat=item.replace(tag,"");cat=cat.split("/")[0],-1===$.inArray(cat,items)&&items.push(cat);break}}return items.join(",")}function startsWith(str,val){var ret=!1;if($.isArray(val)){for(var i=0;i<val.length;i++)if(0===str.indexOf(val[i])){ret=!0;break}}else"string"==typeof str&&(ret=0===str.indexOf(val));return ret}window.getAdParams_SDMax=function(media){var m,sdmax=0,query="",AMPMedia=!(!amp||!amp.feed||"function"!=typeof amp.feed.getData)&&amp.feed.getData(),AMPDuration=!(!((m=AMPMedia)&&m.channel&&m.channel.item&&m.channel.item["media-group"]&&m.channel.item["media-group"]["media-content"]&&m.channel.item["media-group"]["media-content"][0]&&m.channel.item["media-group"]["media-content"][0]["@attributes"])||isNaN(m.channel.item["media-group"]["media-content"][0]["@attributes"].duration))&&m.channel.item["media-group"]["media-content"][0]["@attributes"].duration,duration="boolean"!=typeof AMPDuration?AMPDuration:!(!media||!media.duration)&&media.duration;return-1===(duration=isNaN(duration)?-1:parseFloat(duration))?sdmax=90:duration<=45?sdmax=45:45<duration&&duration<=180?sdmax=60:180<duration&&duration<=600&&(sdmax=90),sdmax&&(query=1e3*sdmax),query},window.getAdParams_SZ=function(media){var sz=["1001x1001"];return window.akamai&&window.akamai.amp&&window.akamai.amp.utils&&window.akamai.amp.utils.Utils&&"flash"===window.akamai.amp.utils.Utils.getPlaybackMode()&&sz.push("1920x1080"),sz.join("|")},window.isLive=function(categories){for(var ret="false",cat=categories||[],x=0;x<cat.length;x++)if(-1<cat[x].indexOf("live_stream")){ret="true";break}return ret},window.createShowCategory=function(category){for(var modified=[],i=0;i<category.length;i++){var item=category[i];startsWith(item,"special")||startsWith(item,"settings")||-1!==$.inArray(item,modified)||modified.push(item)}return modified.join(",")},window.createShowName=function(category){var ret=createCategoryString(category,"on_air/");return"personality"===ret&&(ret=""),ret},window.createShowPersonality=function(category){var ret=createCategoryString(category,"personality/");return ret||(ret=createCategoryString(category,"on_air/personality/")),ret},window.createShowSection=function(category){var val=function(){for(var ret=!1,i=0;i<category.length;i++){var item=category[i];if(0===item.indexOf("primary_")){ret=item.replace("primary_","");break}}return ret}();return val?"partner_content"!==val&&"personality"!==val||(val="null"):val=function(){var ret="",common=["full_episode","hot_topics","on_air","partner_content","personality","promotion","settings","special","web_exclusives","3play_processed"],foxnews=["cleartv","business","latino","mobile","odd_news"],foxbiz=["events","exclusive","government","politics"];foxnews=foxnews.concat(common),foxbiz=foxbiz.concat(common);for(var i=0;i<category.length;i++){var item=category[i];if(/foxnews/.test(window.location.hostname)&&!startsWith(item,foxnews)){ret=item.split("/")[0];break}if(/foxbusiness/.test(window.location.hostname)&&!startsWith(item,foxbiz)){ret=item.split("/")[0];break}val||(ret="false")}return ret}(),val},window.AEP={jsCallbackHandler:function(id,type,data){}}});
Modulr.define("core.video:views/fox-news/iframe/default.rules",["require","jquery","helper","config","@fnc/rules"],function(require,$,Helper,config){var Rules=require("@fnc/rules");return function(opts){opts.app.tve?Rules.set("playername",opts,"qa"===config.cdn.env?"beta_tve":"tve"):Rules.set("playername",opts,Helper.getQueryVar("pn")||opts.player.name),/html/.test(opts.player.mode)&&Rules.set("moat",opts),Rules.set("embedUrl",opts),opts.app.omtrVals||Rules.set("noHeartbeat",opts),opts.app.videoId===config.fncRadioId&&Rules.set("fncRadio",opts),-1<config.heartbeatLive.indexOf(opts.app.videoId)&&Rules.set("heartbeatLive",opts),opts.app.tve&&Rules.set("noShare",opts)}});
Modulr.define("core.video:views/fox-news/iframe/events",["require","jquery","helper","config","models/is.authenticated","@fnc/iframe/default.rules","@fnc/iframe/amp.events","core.plugins:LoadAttempt"],function(require,$,Helper,config,akamai){var API,DefaultRules=require("@fnc/iframe/default.rules"),IsAuthenticated=require("models/is.authenticated"),attempt=function(callback,success){require("core.plugins:LoadAttempt")(150,150,callback,success,function(){Helper.log("warning: failed event attempt!"),Helper.log(callback)})},AMP_EVENTS=require("@fnc/iframe/amp.events"),Events=function(EventListener){this._EventListener=EventListener,this._PLAYER_INSTANCE=null,this._opts=null,this._READY_FOR_EVENTS=!1};return Events.prototype.play=function(){var amp=this._PLAYER_INSTANCE,ready=(this._EventListener,this._READY_FOR_EVENTS);attempt(function(){return!(!ready||!amp||"function"!=typeof amp.play)},function(){setTimeout(function(){amp.play()},150)})},Events.prototype.pause=function(){var amp=this._PLAYER_INSTANCE,ready=(this._EventListener,this._READY_FOR_EVENTS);attempt(function(){return!(!ready||!amp||"function"!=typeof amp.pause)},function(){amp.pause()})},Events.prototype.pauseState=function(callback){var amp=this._PLAYER_INSTANCE,event=this._EventListener,ready=this._READY_FOR_EVENTS;attempt(function(){return!(!ready||!amp||"function"!=typeof amp.getPaused)},function(){var bool=amp.getPaused();event.send("player.pauseState",bool),"function"==typeof callback&&callback(bool)})},Events.prototype.mute=function(){var amp=this._PLAYER_INSTANCE,event=this._EventListener,ready=this._READY_FOR_EVENTS;attempt(function(){return!(!ready||!amp||"function"!=typeof amp.mute)},function(){amp.mute(),event.send("player.mute",{volume:amp.getVolume()})})},Events.prototype.unmute=function(){var amp=this._PLAYER_INSTANCE,event=this._EventListener,ready=this._READY_FOR_EVENTS;attempt(function(){return!(!ready||!amp||"function"!=typeof amp.unmute)},function(){amp.unmute(),event.send("player.unmute",{volume:amp.getVolume()})})},Events.prototype.volume=function(){var amp=this._PLAYER_INSTANCE,event=this._EventListener,ready=this._READY_FOR_EVENTS;attempt(function(){return!(!ready||!amp||"function"!=typeof amp.getVolume)},function(){event.send("player.volume",{volume:amp.getVolume()})})},Events.prototype.volumeSet=function(info){var amp=this._PLAYER_INSTANCE,event=this._EventListener,ready=this._READY_FOR_EVENTS;attempt(function(){return!(!ready||!amp||"function"!=typeof amp.setVolume||"function"!=typeof amp.getVolume)},function(){amp.setVolume(info.val),event.send("player.volume.set",{volume:amp.getVolume()})})},Events.prototype.muteState=function(){var amp=this._PLAYER_INSTANCE,event=this._EventListener,ready=this._READY_FOR_EVENTS;attempt(function(){return!(!ready||!amp||"function"!=typeof amp.getMuted)},function(){event.send("player.muteState",{state:amp.getMuted()})})},Events.prototype.jump=function(data){var amp=this._PLAYER_INSTANCE,event=this._EventListener,ready=this._READY_FOR_EVENTS;if("number"!=typeof data)return!1;var iter=0;attempt(function(){return!(!ready||!amp||"function"!=typeof amp.setCurrentTime)},function(){!function trigger(){var curr=amp.getCurrentTime();isNaN(curr)?iter<100&&(iter++,setTimeout(function(){trigger()},50)):(amp.setCurrentTime(data),event.send("player.jump",!0))}()})},Events.prototype.logout=function(){var amp=this._PLAYER_INSTANCE,ready=(this._EventListener,this._READY_FOR_EVENTS),opts=this._opts;opts.app.auth&&opts.app.auth.enabled&&attempt(function(){return!!(ready&&amp&&amp.auth&&"function"==typeof amp.auth.logout)},function(){Helper.setAISCookie(opts),amp.auth.logout()})},Events.prototype.pageFlag=function(info){this._PLAYER_INSTANCE,this._EventListener,this._READY_FOR_EVENTS},Events.prototype.__change=function(data){var amp=this._PLAYER_INSTANCE,ready=(this._EventListener,this._READY_FOR_EVENTS),urlInfo=Helper.setUrlQuery(window.location.href,{id:data.videoId}),newHash=function(){var res=[];for(var id in urlInfo.hash)res.push([id,urlInfo.hash[id]].join("="));return res="#"+res.join("&")}();window.location.hash=newHash,attempt(function(){return!!(ready&&amp&&amp.feed&&"function"==typeof amp.feed.setData)},function(){var url=function(url){if(/^\/v/.test(url)){var id="foxnews";/insider/.test(domain)?res="insider.foxnews":/foxbusiness/.test(domain)&&(id="foxbusiness"),url="//"+["video",id,"com"].join(".")+url}return url}(config.akamai.feed.replace("${videoId}",data.videoId));$.ajax({url:url,dataType:"json",data:{cb:Helper.cacheBuster(5)},cache:!0,async:!0}).done(function(data){amp.feed.setData(data)})})},Events.prototype.__load=function(opts){var self=this,EventListener=this._EventListener;this._videoId=opts.app.videoId;var loadPlayer=function(){var env,feedurl=(env=Helper.getEnv(),[window.location.protocol,"//","qa"===env?"beta.":"","foxbusiness"===opts.app.domain?"video.foxbusiness.com":"video.foxnews.com",config.akamai.feed.replace("${videoId}",self._videoId)].join(""));_.merge(opts,{player:{feed:{url:feedurl}}}),window.TrackEvent={track:function(data){EventListener.send("metrics.track.event",info)},getPageInfo:function(){return opts.app.leapPageInfo||null}};var useVersion=opts.app.bundleVersion||config.akamai.version,bundlePath=function(){var env="qa"===config.cdn.dev&&"prod"===opts.app.bundleEnv?"prod":null;return Helper.generateBundlePaths(useVersion,env,opts)}();DefaultRules(opts),Helper.loadScript([bundlePath.script],function(){attempt(function(){return!!(window.akamai&&window.akamai.amp&&window.akamai.amp.AMP)},function(){var customConf=_.cloneDeep(opts.player);function next(conf){Helper.log("full video config:",conf),window.amp=window.akamai.amp.AMP.create("player",conf,function(){var mvpdInfo=opts.app.auth&&opts.app.auth.mvpd?opts.app.auth.mvpd:null;mvpdInfo?IsAuthenticated.authorization(opts,function(){self._PLAYER_INSTANCE.addEventListener("authorize",function(){var payload={token:mvpdInfo.token,expiration:mvpdInfo.ttl};self._PLAYER_INSTANCE.authorize(payload)}),cont()}):cont();function cont(){AMP_EVENTS(self._PLAYER_INSTANCE,EventListener,opts),EventListener.send("player.ready.init",{opts:opts,bundleVersion:opts.app.bundleVersion||config.akamai.version}),self._READY_FOR_EVENTS=!0}}),self._PLAYER_INSTANCE=window.amp}Helper.log("passed config:",customConf),window.akamai.amp.AMP.loadDefaults?window.akamai.amp.AMP.loadDefaults(bundlePath.conf,function(){next(customConf)}):window.akamai.amp.AMP.requestJson(bundlePath.conf).then(function(videoConf){next(window.akamai.amp.Utils.override(videoConf,customConf))})})})};if(window.s_account=opts.app.omtrVals?opts.app.omtrVals.s_account:"foxnews",window.omtr)try{delete window.omtr}catch(err){window.omtr=null}if(opts.app.kruxVals&&(Helper.log("Krux values passed:",opts.app.kruxVals),_.merge(opts.player.params,{ksg:opts.app.kruxVals.ksg,kuid:opts.app.kruxVals.kuid})),opts.app.omtrVals&&-1===opts.app.rules.indexOf("noAds")){var shims=[];-1===opts.app.rules.indexOf("noTracking")&&shims.push("adobe.visitor"),shims.push("isa.omniture"),require(shims,function(){_.merge(window.omtr,opts.app.omtrVals.merged),Helper.log("Omniture omtr variable in video iframe:",window.omtr),loadPlayer()})}else loadPlayer()},(API=function(EventListener){this._EventListener=EventListener,this._Events=new Events(EventListener)}).prototype.trigger=function(event,data){this._Events[event]&&this._Events[event](data)},API.prototype.setOpts=function(opts){this._Events._opts=opts},API});
Modulr.define("core.video:views/fox-news/iframe/main",["require","jquery","helper","config","@fnc/listener","@fnc/iframe/amp.functions","core.base:utils/akamai"],function(require,$,Helper,config){var AkamaiTime=require("core.base:utils/akamai").time,EventListener=require("@fnc/listener"),ALL_PLAYER_DEFAULTS={mode:"html",name:"embed",flash:{vars:{live_timestamp_timezone_offset:AkamaiTime.isDST().val?"-4":"-5"}},params:{adparamSDMAX:"#{window.getAdParams_SDMax(media)}",adparamSZ:"#{window.getAdParams_SZ(media)}",paramIsLive:"#{window.isLive(media.category)}",section:"#{window.createShowSection(media.category)}",eVar32:"#{window.createShowName(media.category)}",prop32:"#{window.createShowName(media.category)}",eVar33:"#{window.createShowCategory(media.category)}",prop33:"#{window.createShowCategory(media.category)}",eVar34:"#{window.createShowPersonality(media.category)}",prop34:"#{window.createShowPersonality(media.category)}"},autoadvance:{enabled:!1},mediaanalytics:{dimensions:{device:"#{player.mode}"}},rules:{PDL_LOW:{label:"Android 4 or Kindle Fire HD avoid HLS and get PDL_MED_LOW",regexp:"Android 4"}}},App=function(type,opts){this._type=type,this._opts="object"==typeof opts?opts:{},_.merge(this._opts,{player:_.cloneDeep(ALL_PLAYER_DEFAULTS)}),this._UID=Helper.getQueryVar("uid")||"self",this._EventListener=EventListener.create("parent",this._UID,"iframe")};return App.prototype.set=function(callback){var self=this,opts=this._opts;require(["@fnc/iframe/"+this._type],function(View){new View(opts,self._EventListener,callback)})},App});
Modulr.define("core.video:views/fox-news/iframe/tve",["require","jquery","helper","config","@fnc/iframe/events","@fnc/rules"],function(require,$,Helper,config){var Events=require("@fnc/iframe/events"),Rules=require("@fnc/rules"),PLAYER_DEFAULTS={ais:{enabled:"ais"===config.authMode.type},autoplay:!1,getPlaybackOrder:function(order){if(/Edge|Android|Safari/.test(navigator.userAgent))return["hls","dash","dvr","default","audio"]}};return function(opts,EventListener,callback){var self=this;this._opts=_.merge({player:_.cloneDeep(PLAYER_DEFAULTS)},_.cloneDeep(opts)),this._Events=new Events(EventListener),EventListener.listen(function(event){var name=event.name,data=event.data;"__load"===name?(_.merge(self._opts,data),Rules.setApp(self._opts),self._Events.setOpts(self._opts),self._Events.trigger(name,_.cloneDeep(self._opts)),"function"==typeof callback&&callback(_.cloneDeep(self._opts))):self._Events.trigger(name,data)}),EventListener.send("iframe.ready")}});
Modulr.define("core.video:views/fox-news/iframe/vod",["require","jquery","helper","config","@fnc/iframe/events","@fnc/rules"],function(require,$,Helper,config){var Events=require("@fnc/iframe/events"),Rules=require("@fnc/rules"),PLAYER_DEFAULTS={autoplay:!1};return function(opts,EventListener,callback){var self=this;this._opts=_.merge({player:_.cloneDeep(PLAYER_DEFAULTS)},_.cloneDeep(opts)),this._queryVideoId=Helper.getQueryVar("video_id")||null,this._Events=new Events(EventListener),this._queryVideoId?(_.merge(this._opts,{app:{videoId:this._queryVideoId}}),this._Events.setOpts(this._opts),this._Events.trigger("__load",this._opts)):(EventListener.listen(function(event){var name=event.name,data=event.data;"__load"===name?(_.merge(self._opts,data),Rules.setApp(self._opts),self._Events.setOpts(self._opts),self._Events.trigger(name,_.cloneDeep(self._opts)),"function"==typeof callback&&callback(_.cloneDeep(self._opts))):self._Events.trigger(name,data)}),EventListener.send("iframe.ready"))}});
Modulr.define("core.video:views/fox-news/listener",["require","jquery","lodash","helper","config","@fnc/event.handler"],function(require,$,_,Helper,config){var EventHandler=require("@fnc/event.handler"),API=function(){this._EVENTS_STACK={}};return API.prototype.create=function(target,uid,type){return uid&&target?(type=type||null,this._EVENTS_STACK[uid]||(this._EVENTS_STACK[uid]=new EventHandler(target,uid,type,Helper.setEventName("event.listener."))),this._EVENTS_STACK[uid]):null},API.prototype.get=function(uid){return this._EVENTS_STACK[uid]||null},new API});
Modulr.define("core.video:views/fox-news/rules",["require","jquery","lodash","helper","config","cdn"],function(require,$,_,Helper,config,CDN){var App=function(){};App.prototype.autoplay=function(opts){_.merge(opts.player,{autoplay:!0,usersettings:{enabled:!1},flash:{vars:{user_controlled_autoplay:!0,auto_play_override:!0}}})},App.prototype.autostart=function(opts){_.merge(opts.player,{autoplay:!0,flash:{vars:{user_controlled_autoplay:!0,auto_play_override:!0}}})},App.prototype.noAutoplay=function(opts,props){_.merge(opts.player,{autoplay:!1,usersettings:{enabled:!1},flash:{vars:{user_controlled_autoplay:!0}}})},App.prototype.noAds=function(opts,props){_.merge(opts.player,{ima:{enabled:!1},flash:{vars:{core_ads_enabled:!1}}})},App.prototype.noTracking=function(opts,props){var currOpts,newOpts;currOpts=opts.player,newOpts={nielsen:{enabled:!1},chartbeatanalytics:{enabled:!1},chartbeat:{enabled:!1},comscore:{enabled:!1},comscorestreamsense:{enabled:!1},omniture:{enabled:!1,useJS:!1,heartbeat:{enabled:!1}},plugins:{segment:{enabled:!1}}},_.merge(newOpts,_.cloneDeep(currOpts)),_.merge(currOpts,newOpts)},App.prototype.playername=function(opts,props){var name=props||opts.player.name||"inpage";_.merge(opts.player,{name:name,params:{playerName:name},mediaanalytics:{fields:{pageName:{type:"value",value:name}}},flash:{vars:{core_player_name:name,core_ad_player_name:name,core_omniture_player_name:name}}})},App.prototype.moat=function(opts,props){(!opts.app.rules||(!opts.app.rules||!/(noAds|noTracking)/.test(opts.app.rules.join("|"))))&&_.merge(opts.player,{moat:{data:{partnerCode:"foxima87313513"}}})},App.prototype.embedUrl=function(opts,props){if(!opts.player.params.parentEmbedUrl)try{if(window.location!==window.parent.location){var url=document.referrer;_.merge(opts.player,{params:{parentEmbedUrl:url}})}}catch(err){}},App.prototype.noHls=function(opts,props){_.merge(opts.player,{hls:{enabled:!1}})},App.prototype.noHlsCredentials=function(opts,props){_.merge(opts.player,{hls:{withCredentials:!1}})},App.prototype.heartbeat=function(opts,props){_.merge(opts.player,{omniture:{useJS:!1,heartbeat:{enabled:!0}}})},App.prototype.heartbeatLive=function(opts,props){_.merge(opts.player,{omniture:{useJS:!1,heartbeat:{enabled:!0,liveLinear:{enabled:!0}}}})},App.prototype.noHeartbeat=function(opts,props){_.merge(opts.player,{omniture:{useJS:!1,heartbeat:{enabled:!1}}})},App.prototype.fncRadio=function(opts,props){_.merge(opts.app,{domain:"foxnews",ampConfig:{site:config.akamai.configParam.site.radio}}),_.merge(opts.player,{hls:{withCredentials:!1},omniture:{useJS:!1,heartbeat:{enabled:!0,liveLinear:{enabled:!0}}}})},App.prototype.foxnews=function(opts,props){_.merge(opts.app,{domain:"foxnews",ampConfig:{site:config.akamai.configParam.site.foxnews}})},App.prototype.foxbusiness=function(opts,props){_.merge(opts.app,{domain:"foxbusiness",ampConfig:{site:config.akamai.configParam.site.foxbusiness}})},App.prototype.fncInsider=function(opts,props){_.merge(opts.app,{domain:"video.insider",ampConfig:{site:config.akamai.configParam.site.insider}})},App.prototype.fncNation=function(opts,props){_.merge(opts.app,{domain:"foxnews",ampConfig:{site:config.akamai.configParam.site.nation}})},App.prototype.fbnLive=function(opts,props){_.merge(opts.app,{domain:"foxbusiness",ampConfig:{site:config.akamai.configParam.site["live.foxbusiness"]}})},App.prototype.noShare=function(opts,props){_.merge(opts.player,{sharepanel:{enabled:!1},flash:{vars:{share_mode:"2",show_sharing_overlay:"false",show_email_overlay:"false"}}})},App.prototype.setAIS=function(opts,props){var res,platformID=config.ais.platformId,prefix=props&&props.prefix?props.prefix:null,resourceID=(opts.app.tve?res=opts.app.videoId===config.tve.foxbusiness.videoId?config.tve.foxbusiness.resourceID:config.tve.foxnews.resourceID:opts.app.auth&&(res=(opts.app.auth.domain?config.authenticated[opts.app.auth.domain]:config.authenticated.foxnews).resourceID),res);_.merge(opts.player,{aisPrefix:"video",ais:{platformID:platformID,resourceID:resourceID,contentID:"#{media.guid}",responseTargets:Helper.setResponseTarget(resourceID,prefix),logos:{base:CDN.domain+"/static/orion/img/video/auth-logos/chooser/",group:"top_providers",key:"filename"}},flash:{vars:{core_omniture_account:"foxnewsmaven"}}}),opts.player.omniture||this.heartbeatLive(opts,props),props&&props.redir&&this.authRedir(opts,props.redir),this.noShare(opts)},App.prototype.authRedir=function(opts,props){"string"==typeof props&&_.merge(opts.player,{ais:{redir:props}})},App.prototype.noTitleBar=function(opts,props){_.merge(opts.player,{titlebar:{enabled:!1}})},App.prototype.previewMode=function(opts,props){_.merge(opts.player,{titlebar:{enabled:!1},plugins:{react:{mode:"none"}},captioning:{enabled:!1}})},App.prototype.noKrux=function(opts,props){_.merge(opts.player,{plugins:{krux:{enabled:!1}}})},App.prototype.autoAdvance=function(opts,props){_.merge(opts.player,{autoadvance:{enabled:!0}})};var API,rules=new App;return(API=function(){}).prototype.set=function(id,opts,props){rules[id]&&rules[id](opts,props)},API.prototype.setApp=function(opts){if($.isArray(opts.app.rules)&&0<opts.app.rules.length)for(;0<opts.app.rules.length;){var item=opts.app.rules.shift(),index=item.indexOf(":"),id=item,props=null;-1<index&&(id=item.slice(0,index),props=item.slice(index+1)),rules[id]&&rules[id](opts,props)}},new API});
Modulr.define("core.video:views/vimeo/main",["require","jquery","helper","config","ISA","models/embeds","core.plugins:OnWindowResize"],function(require,$,Helper,config,ISA){var PageEmbed=require("models/embeds"),ARTICLE_BODY=Helper.getArticleBody(),OnWindowResize=require("core.plugins:OnWindowResize"),App=function(target,opts){this._target=target,this._opts=opts||{},this._videoId=target.find(".video-vimeo").attr("video-id"),this._UID=PageEmbed.generateUID(),PageEmbed.initialize(this._UID,"vimeo")};return App.prototype.set=function(id,target){this.setLegacy(this._target,this._videoId)},App.prototype.setLegacy=function(target,videoId){target.each(function(){var elm=$(this),id=videoId||!1;if(!id)return!1;var iframe,body=ARTICLE_BODY,width=body.width(),height=Helper.getHeight(width);elm.html('<iframe src="//player.vimeo.com/video/'+id+'" width="'+width+'px" height="'+height+'px" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>'),iframe=elm.find("iframe:first"),OnWindowResize(function(){var w=body.width(),h=Helper.getHeight(w);iframe.css({width:w,height:h})},50)})},App.prototype.pause=function(){},App});
Modulr.define("core.video:views/youtube/main",["require","jquery","helper","config","ISA","models/embeds","@fnc/listener","core.plugins:OnWindowResize"],function(require,$,Helper,config,ISA){var PageEmbed=require("models/embeds"),ARTICLE_BODY=Helper.getArticleBody(),OnWindowResize=require("core.plugins:OnWindowResize"),App=function(target,opts){this._target=target,this._opts=opts||{},this._videoId=target.find(".video-youtube").attr("video-id"),this._INITIALIZED=!1,this._UID=PageEmbed.generateUID(),PageEmbed.initialize(this._UID,"youtube")};return App.prototype.set=function(id,target){this.setLegacy(this._target,this._videoId)},App.prototype.setLegacy=function(target,videoId){target.each(function(){var elm=$(this),id=videoId||!1;if(!id)return!1;var iframe,body=ARTICLE_BODY,width=body.width(),height=Helper.getHeight(width);elm.html('<iframe src="//www.youtube.com/embed/'+id+'?version=3&enablejsapi=1" frameborder="0" style="width:'+width+"px; height:"+height+'px;"></iframe>'),iframe=elm.find("iframe:first"),OnWindowResize(function(){var w=body.width(),h=Helper.getHeight(w);iframe.css({width:w,height:h})},50)})},App});
!function(Modulr,FNC){if(Modulr.getInstance("core.video"))return;var App,config={instance:"core.video",baseDomain:FNC.CDN.domain,baseUrl:"/static/orion/scripts/core/video/app",masterFile:"/static/orion/scripts/core/utils/modulr/master.js",paths:{"@fnc":"views/fox-news","@youtube":"views/youtube","@vimeo":"views/vimeo"},packages:["core.plugins","core.base"],shim:{jquery:{src:"/static/orion/scripts/core/utils/jquery/core.js",exports:"jQuery"},"jquery.cookie":{src:"/static/orion/scripts/core/utils/jquery/plugins/cookie.js",exports:"jQuery.cookie"},lodash:{src:"/static/orion/scripts/core/utils/lodash.js",exports:"_"},"isa.omniture":{src:"//global.fncstatic.com/static/isa/app/lib/omtr_code.js",exports:"omtr"},"adobe.visitor":{src:"//global.fncstatic.com/static/isa/app/lib/VisitorAPI.js",exports:"Visitor"}}},Instance=Modulr.config(config);Instance.define("cdn",function(){return FNC.CDN}),Instance.define("akamai.ver",function(){return"7.109.10"}),Instance.define("ISA",function(){return FNC.ISA||null}),Instance.define("cache.param",["core.base:utils/environment"],function(Env){return Env.getCacheParam()}),window.FNC.core.video=window.FNC.core.video||((App=function(){this._app=null}).prototype.getInfo=function(){if(this._app)return this._app.getInfo()},App.prototype.load=function(callback){if("function"==typeof callback){var self=this;self._app?callback(app):Instance.require(["api"],function(app){self._app=app,callback(app)})}},App.prototype.getHelper=function(callback){"function"==typeof callback&&Instance.require(["helper"],function(Helper){callback(Helper)})},new App),function(){var override=!1;if(override&&(override=!0,window.console.log)){var orig=window.console.log;window.console.log=function(){var args=Array.prototype.slice.call(arguments);if(-1!==args.indexOf("[core.video]"))try{return orig.apply(orig,args)}catch(err){orig(args.join(" | "))}}}}()}(window.Modulr,window.FNC);