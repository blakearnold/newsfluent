
/** updated: 05-08-2019 09:06 PM **/


!function(LeapApp){window.leapmetrics=window.leapmetrics||[],function(Leap){if(window.leapmetrics)if("object"==typeof window.leapmetrics)if(Array.isArray(window.leapmetrics)){if(0<window.leapmetrics.length)for(;0<window.leapmetrics.length;){var item=window.leapmetrics.shift();Leap.execute(item)}instantiate()}else window.leapmetrics.hasOwnProperty("push")||instantiate();else instantiate();else instantiate();function instantiate(){window.leapmetrics={push:function(){Leap.execute(arguments[0]||null)},pageMetrics:function(pageId){Leap.execute(function(API){API.pageMetrics(pageId)})},__def:window.leapmetrics.__def||function(){return!0}}}}(LeapApp)}(function(Modulr,DocumentReady){return new(function(){var version;Modulr.setGlobalCacheParam((/@deployversion/i.test(version="201905082106")&&(version=Modulr.version),version)),Modulr.setGlobalCacheCond([{regex:/geo\.js/,param:"cb",noStore:!0}]),DocumentReady(function(){Modulr.setReady()});var Instance=Modulr.config({instance:"leap.metrics",baseDomain:"//static.foxnews.com",baseUrl:"/static/leap/app",shim:{"akamai.geo":{src:"https://static.foxnews.com/static/orion/scripts/core/utils/geo.js",exports:"FNC.GEO"},"util.jquery":{src:"/static/leap/ext/shims/jq.js",exports:"leapmetrics.__def.jq"},"util.lodash":{src:"/static/leap/ext/shims/ld.js",exports:"leapmetrics.__def.ld"}},paths:{"@PageInfo":"core/properties/index"}});return Instance.define("documentReady",function(){return DocumentReady}),Instance.define("jquery",["util.jquery"],function(){return window.leapmetrics.__def.jq}),Instance.define("lodash",["util.lodash"],function(){return window.leapmetrics.__def.ld}),function(){function TrackMap(require,config,Helper){var Tracking={"auth.profile:sign-in-start":function(attrs){return{event:"Profile Sign In Started",desc:"User starts signing into a profile",options:{page_profile_type:attrs.page_profile_type||"general",page_start_source:attrs.page_start_source||"general"}}},"auth.profile:sign-in-complete":function(attrs){return{event:"Profile Sign In Completed",desc:"User successfully signs into a profile",options:{page_profile_type:attrs.page_profile_type||"general",page_start_source:attrs.page_start_source||"general"}}},"auth.profile:sign-in-error":function(attrs){return{event:"Profile Sign In Error",desc:"User experiences an error",options:{page_error_description:attrs.page_error_description||"no error description",page_error_type:attrs.page_error_type||"no error type",page_start_source:attrs.page_start_source||"general"}}},"auth.profile:sign-in-forgot-password":function(attrs){return{event:"Profile Sign In Forgot Password",desc:"User selects a CTA to retrieve password",options:{page_start_source:attrs.page_start_source||"general"}}},"auth.profile:sign-up-start":function(attrs){return{event:"Profile Sign Up Started",desc:"User starts signing up for a profile",options:{page_start_source:attrs.page_start_source||"general"}}},"auth.profile:sign-up-complete":function(attrs){return{event:"Profile Sign Up Completed",desc:"User completes signing up for a profile",options:{page_profile_type:attrs.page_profile_type||"general",page_start_source:attrs.page_start_source||"general"}}},"auth.profile:sign-up-error":function(attrs){return{event:"Profile Sign Up Error",desc:"User experiences an error",options:{page_error_description:attrs.page_error_description||"no error description",page_error_type:attrs.page_error_type||"no error type",page_start_source:attrs.page_start_source||"general"}}},"auth.profile:logout":function(attrs){return{event:"Profile Logged Out",desc:"User successfully logged out of a profile"}},share:function(attrs){var required=["page_content_shared","page_share_method"],desc="User shares any content via email, facebook, twitter, etc.";return requiredSet(required,attrs)?{event:"Share",desc:desc,options:{page_share_method:attrs.page_share_method,page_content_shared:attrs.page_content_shared}}:{error:!0,event:"Share",desc:desc,required:required,optional:[]}},"commenting:posted":function(attrs){return{event:"Comment Posted",desc:"User posts a comment on an article, thread, etc."}},"auth.mvpd:start":function(attrs){return{event:"Authentication Started",desc:"User lands on the screen to begin MVPD authentication",options:{page_start_source:attrs.page_start_source||"general"}}},"auth.mvpd:select-provider-start":function(attrs){return{event:"Authentication Select Provider Started",desc:"User lands on the screen",options:{page_start_source:attrs.page_start_source||"general"}}},"auth.mvpd:select-provider-complete":function(attrs){var eventId="Authentication Select Provider Completed",required=["page_action_type"],desc="User selects a MVPD and successfully moves on to the next step",optional={page_start_source:"general"};return requiredSet(required,attrs)?{event:eventId,desc:desc,options:{page_start_source:attrs.page_start_source||optional.page_start_source,page_action_type:attrs.page_action_type}}:{error:!0,event:eventId,desc:desc,required:required,optional:optional}},"auth.mvpd:select-provider-error":function(attrs){return{event:"Authentication Select Provider Error",desc:"User experiences a MVPD error",options:{page_error_description:attrs.page_error_description||"no error description",page_error_type:attrs.page_error_type||"no error type",page_start_source:attrs.page_start_source||"general"}}},"auth.mvpd:complete":function(attrs){return{event:"Authentication Completed",desc:"User successfully authenticates with a MVPD",options:{page_start_source:attrs.page_start_source||"general"}}},"auth.mvpd:logout":function(attrs){return{event:"Authentication Logged Out",desc:"User successfully logged out of a MVPD"}},"search:start":function(attrs){return{event:"Search Started",desc:"User initiates a search"}},"search:complete":function(attrs){var desc="User completes a search",required=["page_search_term","page_num_search_results"];return requiredSet(required,attrs)?{event:"Search Completed",desc:desc,options:{page_search_term:attrs.page_search_term,page_num_search_results:attrs.page_num_search_results}}:{error:!0,event:"Search Completed",desc:desc,required:required,optional:{}}},"search:select":function(attrs){var eventId="Search Result Selected",desc="User selects a search result",required=["page_search_term","page_num_search_results","page_item_title"];return requiredSet(required,attrs)?{event:eventId,desc:desc,options:{page_search_term:attrs.page_search_term,page_num_search_results:attrs.page_num_search_results,page_item_title:attrs.page_item_title}}:{error:!0,event:eventId,desc:desc,required:required,optional:{}}},"favorites:add":function(attrs){var desc="User saves an article, favorites a show, favorites a personality, etc",required=["page_item_title","page_category_title"],optional={page_item_type:"no item type"};return requiredSet(required,attrs)?{event:"Added Favorites",desc:desc,options:{page_item_title:attrs.page_item_title,page_category_title:attrs.page_category_title,page_item_type:attrs.page_item_type||optional.page_item_type}}:{error:!0,event:"Added Favorites",desc:desc,required:required,optional:optional}},"favorites:remove":function(attrs){var desc="User removes a previously saved article, favorited show, favorited personality, etc",required=["page_item_title","page_category_title"];return requiredSet(required,attrs)?{event:"Removed Favorites",desc:desc,options:{page_item_title:attrs.page_item_title,page_category_title:attrs.page_category_title,page_item_type:attrs.page_item_type||"no item type"}}:{error:!0,event:"Removed Favorites",desc:desc,required:required}},"banner:impression":function(attrs){var eventId="Banner Notification Impression",desc="User receives a banner notification",required=["page_message_title","page_message_text","page_message_type","page_message_id"];return requiredSet(required,attrs)?{event:eventId,desc:desc,options:{page_message_title:attrs.page_message_title,page_message_text:attrs.page_message_text,page_message_type:attrs.page_message_type,page_message_id:attrs.page_message_id}}:{error:!0,event:eventId,desc:desc,required:required}},"banner:action":function(attrs){var eventId="Banner Notification Action",desc="User takes action on a banner notification",required=["page_message_title","page_message_text","page_message_type","page_message_id","page_action_type"];return requiredSet(required,attrs)?{event:eventId,desc:desc,options:{page_message_title:attrs.page_message_title,page_message_text:attrs.page_message_text,page_message_type:attrs.page_message_type,page_message_id:attrs.page_message_id,page_action_type:attrs.page_action_type}}:{error:!0,event:eventId,desc:desc,required:required}},"newsletter:sign-up-start":function(attrs){var eventId="Newsletter Sign Up Started",required=["page_newsletter_list"],desc="User starts signing up for a newsletter";return requiredSet(required,attrs)?{event:eventId,desc:desc,options:{page_newsletter_list:attrs.page_newsletter_list}}:{error:!0,event:eventId,desc:desc,required:required}},"newsletter:sign-up-complete":function(attrs){var eventId="Newsletter Sign Up Completed",required=["page_newsletter_list"],desc="User successfully submits an email to sign up for newsletters";return requiredSet(required,attrs)?{event:eventId,desc:desc,options:{page_newsletter_list:attrs.page_newsletter_list}}:{error:!0,event:eventId,desc:desc,required:required}},"podcast:start":function(attrs){var required=["page_item_title"],desc="User starts a podcast";return requiredSet(required,attrs)?{event:"Podcast Started",desc:desc,options:{page_item_title:attrs.page_item_title}}:{error:!0,event:"Podcast Started",desc:desc,required:required}},"podcast:complete":function(attrs){var required=["page_item_title"],desc="User completes a podcast";return requiredSet(required,attrs)?{event:"Podcast Completed",desc:desc,options:{page_item_title:attrs.page_item_title}}:{error:!0,event:"Podcast Completed",desc:desc,required:required}}};function requiredSet(arr,obj){for(var ret=!0,i=0;i<arr.length;i++)if(!obj[arr[i]]){ret=!1;break}return ret}return{get:function(name,data){var attrs=data&&data.props&&data.props.attrs?data.props.attrs:{};return Tracking[name]?Tracking[name](attrs,data):null},getMapList:function(raw){var map={};for(var id in Tracking){var item=Tracking[id]({}),eventId=item.event||item.eventId||null;eventId&&(map[id]=raw?item:eventId)}return map}}}Modulr.define("leap.metrics:core/api",["require","lodash","core/helper","core/config","@PageInfo","core/utils/meta","core/utils/promise","core/utils/log","core/utils/script.loader","core/properties/cookie","core/events/page","core/events/track"],function(require,_,Helper,config,PageInfo){var Meta=require("core/utils/meta"),PromiseUtil=require("core/utils/promise"),CookieProperties=require("core/properties/cookie"),Page=require("core/events/page"),Track=require("core/events/track"),log=require("core/utils/log")("segment.api"),announce=require("core/utils/log")(null,!0);config.flag&&require(["jquery","lodash"],function($,_){log("versions: jquery=v"+$().jquery+"; lodash=v"+_.VERSION+"; Modulr: v"+Modulr.version)});return function(props){var Proto=this,PROPERTIES=props||{};PROPERTIES.__custom={};var IS_DISABLED=PROPERTIES.disabled||!1,INITIALIZED=!1,EXECUTION_STACK=[],INITIALIZE_ONCE=!1;Proto.track=function(name,attrs,callback){return new PromiseUtil(function(resolve,reject){var info,trigger;if(IS_DISABLED||!name)return reject();info={name:name,attrs:attrs,meta:Proto.meta(),siteId:Meta.getSiteId(),custom:PROPERTIES.__custom},trigger=function(){Track.trigger(info).then(function(data){resolve(data)})},INITIALIZED?trigger():EXECUTION_STACK.push(trigger)})},Proto.identify=function(name,attrs,callback){if(!IS_DISABLED){var info={name:name,attrs:attrs,siteId:Meta.getSiteId(),custom:PROPERTIES.__custom},trigger=function(){announce("todo: identify",info)};INITIALIZED?trigger():EXECUTION_STACK.push(trigger)}},Proto.setProp=function(){if(INITIALIZE_ONCE)return log("[ERROR] cannot set a custom property after an initialization!");var args=arguments;if(PROPERTIES.__custom=PROPERTIES.__custom||{},"string"==typeof args[0]&&void 0!==args[1]){var key=args[0],val=args[1];"function"==typeof val?log("setting custom property:",key," = (function)"):log("setting custom property:",key,"=",val),PROPERTIES.__custom[key]=val}else"object"!=typeof args[0]||Array.isArray(args[0])||(log("setting custom properties:",args[0]),_.merge(PROPERTIES.__custom,args[0]))},Proto.meta=function(forceReload){return Meta.get(forceReload)},Proto.pageInfo=function(){return PageInfo()},Proto.initialize=function(view,meta){var args=arguments;return new PromiseUtil(function(resolve,reject){if(IS_DISABLED)return resolve();INITIALIZE_ONCE&&EXECUTION_STACK.push(function(){resolve()}),INITIALIZE_ONCE=!0,log("Initializing..");var info,obj,conf=(info={view:"browser",meta:null,siteId:null,keyId:null,custom:{}},"object"==typeof args[0]?(obj=args[0],info.view=obj.view||info.view,info.siteId=obj.siteId||null,info.keyId=obj.keyId||null,info.custom=obj.custom||{}):info.view=view||info.view,-1<["amp","fbia"].indexOf(info.view)&&meta&&(info.meta=meta),info);if(conf.siteId=conf.siteId||Meta.get(!0).page.siteId||"other",Meta.setSiteId(conf.siteId),"browser"===conf.view&&(conf.meta=Meta.get(!0)),conf.keyId=conf.keyId||config.SEGMENT_KEY[conf.siteId]||null,!conf.keyId||!conf.meta)return IS_DISABLED=!0,conf.keyId?conf.meta||announce('[WARNING] disabled! no meta for site: "'+conf.siteId+'"'):announce('[WARNING] disabled! no key for site: "'+conf.siteId+'"'),resolve(!1);conf.custom=_.merge(PROPERTIES.__custom,conf.custom),require(["core/providers/segment/load"],function(Init){Init(conf.siteId,conf.keyId),log("Initialization done!"),PageInfo.initialize(conf.custom),Page.trigger(conf).then(function(){resolve(),function(){for(;0<EXECUTION_STACK.length;){var fn=EXECUTION_STACK.shift();fn()}}(),INITIALIZED=!0})})})},Proto.pageMetrics=function(pageId){IS_DISABLED||announce("[ WARN ] Page Events has been deprecated!")},Proto.pageEvent=function(name,data){IS_DISABLED||announce("[ WARN ] Page Events has been deprecated!")},Proto.cookieProps=CookieProperties}}),Modulr.define("leap.metrics:core/config",["require"],function(require){var res,config={};return config.version="v17",config.deployTimestamp="201905082106",config.flag=-1<window.location.search.indexOf("_leap=1"),config.env=res=/\@buildEnv/i.test(res="prod")?"prod":-1<["dev","stage","prod"].indexOf(res)?res:"prod",config.hostPath="//static.foxnews.com/static/leap",config.SEGMENT_KEY={fnc:"4I2fAtE5IxTlczNT3F91OckHtI5wfR7g",fbn:"8eHBndHSjYxRMyj3exjJdOCozQOktBab",nation:"zF2CN4vDTQaohrGCQnxqTIda1NSn4PEF",radio:"qB8yWKOOtThTzX7H4FhljWq4F21AR1pl",insider:"4mXEBmj4qFaNMeqCa6nSpPxjDP5d3usc"},config.EU_List=["segment"],config}),Modulr.define("leap.metrics:core/events/page",["require","core/config","core/helper","core/utils/meta","core/utils/log","core/utils/script.loader"],function(require,config,Helper,Meta){require("core/utils/log")("events.page");var ScriptLoader=require("core/utils/script.loader"),PROVIDER_LIST=["segment"];return new function(){this.trigger=function(props){var siteId,view=props.view||"browser";return props.meta,"browser"===view&&-1<["fbn","fnc"].indexOf(props.siteId)&&(siteId=props.siteId,ScriptLoader(config.hostPath+"/sites/"+siteId+"/metrics.js?v="+config.deployTimestamp)),Helper.executeModules(PROVIDER_LIST,props,"core/providers/$1/page")}}}),Modulr.define("leap.metrics:core/events/track",["require","core/config","core/helper","core/utils/meta","core/utils/log"],function(require,config,Helper,Meta){require("core/utils/log")("events.page");var PROVIDER_LIST=["segment"];return new function(){this.trigger=function(props){return Helper.executeModules(PROVIDER_LIST,{props:props},"core/providers/$1/track")}}}),Modulr.define("leap.metrics:core/helper",["require","core/utils/promise","core/utils/promise.iterator","core/utils/log"],function(require,PromiseUtil,PromiseIterator){var log=require("core/utils/log")("helper");return new function(){this.executeModules=function(modules,data,replacePath){return new PromiseUtil(function(resolve,reject){var dataset={};PromiseIterator(modules,function(next,i,step,stop){var moduleId=modules[i],modulePath=moduleId;replacePath&&(modulePath=replacePath.replace("$1",moduleId)),require([modulePath],function(Mod){"function"==typeof Mod.trigger?Mod.trigger(data).then(function(data){dataset[moduleId]=data||null,step()}):(log("module does not have a promise:",modules[i]),dataset[moduleId]=null,step())})},function(){resolve(dataset)})})},this.isFn=function(val){return"function"==typeof val},this.getTrackingNameDetails=function(val){var sp=val.split(":"),bool=0<sp.length;return{id:bool?sp.slice(1).join(":"):val,group:bool?sp[0]:null}},this.removeNulls=function(obj){for(var id in obj)null===obj[id]&&delete obj[id];return obj}}}),Modulr.define("leap.metrics:core/properties/_shared",["require","core/properties/cookie"],function(require,CookieProperties){return new function(){this.getAppName=function(siteId){var res;switch(siteId){case"insider":res="insider.foxnews.com";break;case"radio":res="radio.foxnews.com";break;case"nation":res="foxnation";break;case"fbn":res="foxbusiness.com";break;case"fnc":res="foxnews.com";break;default:res="other"}return res},this.getNameMap=function(){return{"section-front":"Category Landing",category:"Subcategory Landing",article:"Article Landing",video:"Video Landing",playlist:"Video Playlist",homepage:"Homepage",other:"Other"}},this.getCookieValues=function(){return CookieProperties()}}}),Modulr.define("leap.metrics:core/properties/browser",["require","lodash","core/helper","core/config","core/properties/_shared","core/utils/meta","core/utils/datetime","core/utils/query.param","akamai.geo"],function(require,_,Helper,config,Shared,Meta){var DateTime=require("core/utils/datetime"),QueryParam=require("core/utils/query.param"),NAME_MAP=Shared.getNameMap();return function(opts){var siteId,version,obj,CURRENT_TIMESTAMP=window.FNC.GEO.time.getCurrent(),cookieVals=Shared.getCookieValues(),meta=(opts=opts||{}).meta||Meta.get(!0),custom=opts.custom||{},info={name:NAME_MAP[meta.page.type]||meta.page.type,category:meta.raw["prism.section"]||null,page:{title:meta.page.title,url:meta.page.url,path:meta.page.path,referrer:document.referrer||""}};function getMetaDate(dt,both){var sp=function(val){var res="";if(-1<val.indexOf("T"))res=val.split("T");else if(/^([0-9]{4})\-([0-9]{1,2})\-([0-9]{1,2})(.+)(AM|PM)$/.test(val)){var match=val.match(/^([0-9]{4})\-([0-9]{1,2})\-([0-9]{1,2})(.+)(AM|PM)$/);if(match&&6===match.length)val=[match[2],match[3],match[1]].join("/")+match[4]+match[5],res=DateTime(new Date(val),"%Y-%m-%d %H:%i:%s").split(" ")}return res}(dt||""),date=sp[0]||"",time=sp[1]||"";return both?(time&&(time=time.split(":").slice(0,2).join(":")),{date:date,time:time}):date.split("-")}function setProp(val){var siteVal=function(siteId){var res;switch(meta.page.siteId){case"insider":res="news-insider";break;case"radio":res="news-radio";break;case"nation":res="news-nation";break;case"fbn":res="business";break;case"fnc":res="news";break;default:res="other"}return res}(),ret="other"===siteVal?"other:web":"fox:"+siteVal+":web",add=concat(val);return 0<add.length&&(ret+=":"+add),ret}function concat(val){var ret="";if(val&&"string"==typeof val)ret=val;else if(val&&Array.isArray(val)&&0<val.length){for(var agg=[],i=0;i<val.length;i++)val[i]&&agg.push(val[i]);0<agg.length&&(ret=agg.join(":"))}return ret}return info.options=(version=config.version,obj={properties:{primary_business_unit:"other"!==meta.page.siteId?"news":"",secondary_business_unit:(siteId=meta.page.siteId,/^fbn/.test(siteId)?"business":"other"===siteId?"":"news"),app_name:Shared.getAppName(meta.page.siteId),app_platform:"web",app_version:version,appsflyer_id:null},traits:{dcg_profile_id:"",appsflyer_id:"",mvpd:cookieVals.mvpdId||"",network_entitlement_list:"",lastAnonymousProfileId:"",lastKnownProfileId:""}},Helper.removeNulls(obj.properties),Helper.removeNulls(obj.traits),obj),info.properties=function(){var q,res,datesInfo,created,modified,major,obj={author:meta.raw["dc.publisher"]||null,page_name:setProp(meta.raw["prism.section"])||"no name",page_type:function(){var res=meta.raw["prism.section"];if(-1<["category","article"].indexOf(meta.page.type)){var alt=concat([meta.raw["prism.subsection1"],meta.raw["prism.subsection2"]]);res=alt||res}"root"===res&&(res="homepage");return res}()||"other",app_name:Shared.getAppName(meta.page.siteId),app_platform:"web",app_version:config.version,app_build:config.deployTimestamp,page_timePartingDay:DateTime(CURRENT_TIMESTAMP,"%D"),page_timePartingHour:function(d){var res=[];res.push(DateTime(d,"%H"));var min=parseInt(DateTime(d,"%i"),10);return res.push(min<30?"00":"30"),res.join(":")}(CURRENT_TIMESTAMP)};for(var id in info.options.properties)obj[id]=info.options.properties[id];if("other"===meta.page.siteId)return obj;if("category"===meta.page.type)_.merge(obj,{page_name:setProp([meta.raw["prism.subsection1"],meta.raw["prism.subsection2"]]),page_content_level_1:setProp(),page_content_level_2:setProp([meta.raw["prism.subsection1"]]),page_content_level_3:setProp([meta.raw["prism.subsection1"],meta.raw["prism.subsection2"]]),page_content_level_4:setProp([meta.raw["prism.subsection1"],meta.raw["prism.subsection2"],meta.raw["prism.subsection3"]])});else if("article"===meta.page.type){var category=meta.raw["classification-isa"]?meta.raw["classification-isa"].split(",")[0]:"",date=getMetaDate(meta.raw["dc.date"]),articleProps=[meta.raw["prism.section"],date[0],date[1],date[2],(meta.raw["og:title"]||meta.raw["dc.title"]||$("title:first").text()||"").replace(/\:/g,"\\:")];_.merge(obj,{page_type:concat([meta.raw["prism.section"],category]),page_name:setProp(articleProps),page_content_level_1:setProp(articleProps.slice(0,1)),page_content_level_2:setProp(articleProps.slice(0,2)),page_content_level_3:setProp(articleProps.slice(0,3)),page_content_level_4:setProp(articleProps)})}else _.merge(obj,{page_content_level_1:setProp(),page_content_level_2:setProp(meta.raw["prism.section"]),page_content_level_3:setProp([meta.raw["prism.section"],meta.raw["prism.subsection1"]]),page_content_level_4:setProp([meta.raw["prism.section"],meta.raw["prism.subsection1"],meta.raw["prism.subsection2"]])});return _.merge(obj,{page_test_name:null,push_enabled:null,appsflyer_tracking_code:null,campaign_tracking_code:(q=QueryParam.getVal("cmpid"),res=null,/^org\=/.test(q)&&(res=q),res),campaign_int_tracking_code:function(q){var res=null;return/^int_org\=/.test(q)?res=q:"fnc"===meta.page.siteId&&q&&(res=q),res}(custom.intcmp||QueryParam.getVal("cmpid")||""),campaign_organization:null,campaign_marketing_channel:null,campaign_source:null,campaign_name:null,campaign_additional:null,campaign_agency:null,page_content_type:meta.page.type,page_content_category:(obj.page_type||"").split(":")[0]||null,page_content_distributor:"owned",page_content_originator:function(ptype){var res=null;return"article"===(meta.page.type||"")&&meta.raw["dc.source"]&&(res=meta.raw["dc.source"]),res}(),page_content_language:meta.raw["dc.language"]||null,page_login_state:null,page_content_type_of_story:function(source){var res=null;if("article"!==meta.page.type)return res;switch(res="original",meta.page.siteId){case"fnc":/fox(.+|)news/i.test(source)||(res="partners");break;case"fbn":/fox(.+|)business/i.test(source)||(res="partners")}return res}(meta.raw["dc.source"]||""),page_content_version:null,page_is_dark_mode:!1}),datesInfo={created:getMetaDate(meta.raw["dcterms.created"],!0),modified:getMetaDate(meta.raw["dcterms.modified"],!0),major:getMetaDate(meta.raw["dcterms.modified"],!0)},created=datesInfo.created,modified=datesInfo.modified,major=datesInfo.major,_.merge(obj,{page_content_original_publish_date:created.date||null,page_content_major_publish_date:major.date||null,page_content_modified_date:modified.date||null,page_content_original_publish_time:created.time||null,page_content_major_publish_time:major.time||null,page_content_modified_time:modified.time||null}),info.pageOnlyProperties=function(){var res,props={keywords:meta.raw.keywords||null,page_content_personality:null,page_content_author:(res=null,"article"===(meta.page.type||"")&&meta.raw["dc.creator"]&&(res=meta.raw["dc.creator"]),res),page_content_author_secondary:null,page_content_title:meta.page.title,page_content_id:meta.raw["dc.identifier"]||null,page_content_tags:meta.raw["classification-isa"]||null,page_content_subcategory:(obj.page_type||"").split(":")[1]||null};return _.merge(obj,props),null}(),Helper.removeNulls(obj),obj}(),info}}),Modulr.define("leap.metrics:core/properties/cookie",["require","core/utils/cookie"],function(require,Cookie){return function(type,keyVal){var data=function(str){var res={};if(str)try{res=JSON.parse(str)}catch(err){}return res}(Cookie("__leap_props"));if("set"===type&&"object"==typeof keyVal){for(var id in keyVal)keyVal.hasOwnProperty(id)&&(data[id]=keyVal[id]||"");Cookie("__leap_props",JSON.stringify(data),{expires:30,path:"/",domain:window.location.hostname.replace(/(.+)\.(.+)\.com$/,".$2.com")})}return data}}),Modulr.define("leap.metrics:core/properties/index",["require","lodash","core/properties/browser","core/properties/token","core/utils/log"],function(require,_,Browser,Token){var log=require("core/utils/log")("@PageInfo"),announce=require("core/utils/log")(null,!0),CUSTOM_OVERRIDES=null,App=function(attrs){var res;if(res="token"===(attrs=attrs||{}).type?Token(attrs):Browser(attrs),CUSTOM_OVERRIDES){var overrides=CUSTOM_OVERRIDES(res,attrs);overrides?"object"!=typeof overrides||Array.isArray(overrides)||(log("custom override data:",overrides),res=_.merge(res,overrides),log("custom data result:",res)):announce("[ WARNING ] custom page info overrides returned nothing!")}return res};return App.initialize=function(custom){custom&&"function"==typeof custom["custom.page.info"]&&(CUSTOM_OVERRIDES=custom["custom.page.info"]);try{delete App.initialize}catch(err){App.initialize=null}},App}),Modulr.define("leap.metrics:core/properties/token",["require","lodash","core/helper","core/config","core/properties/_shared","core/utils/meta","core/utils/datetime","akamai.geo"],function(require,_,Helper,config,Shared,Meta){var DateTime=require("core/utils/datetime"),NAME_MAP=Shared.getNameMap();return function(opts){var val,res,CURRENT_TIMESTAMP=window.FNC.GEO.time.getCurrent(),view=opts.view,meta=opts.meta||{},siteId=(opts.custom,val=meta.prop15||"",val=/business/i.test(val)?"fbn":/insider/i.test(val)?"insider":/nation/i.test(val)?"nation":/news/.test(val)?"fnc":"other"),appName=Shared.getAppName(siteId),path=function(val){return val&&(val="/"+(val=val.replace(/\:/g,"/"))),val}(meta.prop40||""),name=function(val){return NAME_MAP[val]||val}(meta.prop13||"article"),url=(res=["https://"],/(fnc|fbn)/.test(siteId)&&res.push("www."),res.push(appName+path),res.join("")),info={name:name,page:{title:meta.prop12||"no title",url:url,path:path,search:""}};return info.properties={keywords:"",page_name:meta.prop1||"",page_type:meta.prop1||"",app_name:appName,app_platform:"web",app_version:config.version,app_build:config.deployTimestamp,page_timePartingDay:DateTime(CURRENT_TIMESTAMP,"%D"),page_timePartingHour:function(d){var res=[];res.push(DateTime(d,"%H"));var min=parseInt(DateTime(d,"%i"),10);return res.push(min<30?"00":"30"),res.join(":")}(CURRENT_TIMESTAMP),page_test_name:null,push_enabled:null,appsflyer_tracking_code:null,campaign_tracking_code:null,campaign_int_tracking_code:null,campaign_organization:null,campaign_marketing_channel:null,campaign_source:null,campaign_name:null,campaign_additional:null,campaign_agency:null,page_content_personality:null,page_content_author:meta.prop14||null,page_content_author_secondary:null,page_content_version:null,page_content_title:meta.prop12||null,page_content_id:meta.prop11||null,page_content_type:meta.prop13||null,page_content_type_of_story:null,page_content_tags:meta.hier1||null,page_content_category:meta.prop1||null,page_content_subcategory:null,page_content_language:null,page_login_state:null,page_content_originator:meta.prop15||null,page_content_distributor:view,page_content_original_publish_date:meta.prop54||null,page_content_major_publish_date:meta.prop54||null,page_content_modified_date:meta.prop54||null,page_content_original_publish_time:null,page_content_major_publish_time:null,page_content_modified_time:null},info.options={properties:{primary_business_unit:"news",secondary_business_unit:function(siteId){return/business/.test(siteId)?"business":"news"}(meta.prop15||""),app_name:appName,app_platform:"web",app_version:config.version},traits:{dcg_profile_id:"",appsflyer_id:"",mvpd:"",network_entitlement_list:"",lastAnonymousProfileId:"",lastKnownProfileId:""}},_.merge(info.properties,info.page),Helper.removeNulls(info.properties),info}}),Modulr.define("leap.metrics:core/providers/segment/load",["require","core/config","core/utils/log","core/utils/eu"],function(require,config){var log=require("core/utils/log")("segment.load"),announce=require("core/utils/log")(null,!0);require("core/utils/eu").allowProvider("segment");return function(siteId,keyId){if(!window.analytics){var KEY_ID=keyId||config.SEGMENT_KEY[siteId];if(log("segment key id ["+siteId+"]:",KEY_ID),!KEY_ID)return announce("[error] no key id! for:",siteId);!function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0,analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"],analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);return e.unshift(t),analytics.push(e),analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)},analytics.SNIPPET_VERSION="4.0.0"}}(),window.analytics.load(KEY_ID)}}}),Modulr.define("leap.metrics:core/providers/segment/page",["require","jquery","core/config","core/utils/meta","@PageInfo","core/utils/log","core/utils/promise","core/utils/datetime","core/utils/query.param","akamai.geo"],function(require,$,config,Meta,PageInfo){var log=require("core/utils/log")("segment.page.call"),PromiseUtil=require("core/utils/promise");require("core/utils/datetime"),require("core/utils/query.param");return new function(){var TRIGGERED=!1,VALID_VIEWS=(FNC.GEO.time.getCurrent(),["browser","amp","fbia"]);this.trigger=function(props){var meta=props.meta,view=props.view;return new PromiseUtil(function(resolve,reject){if(!(-1<VALID_VIEWS.indexOf(view)))return log("[error] Invalid page view type:",view),resolve();if("other"===props.siteId&&log("[warning] siteId not detected.",!0),TRIGGERED)return resolve();if(TRIGGERED=!0,"browser"===view&&function(meta,custom){var url=meta.page.url,res=!1;if(Array.isArray(custom.noPageEvent))for(var i=0,len=custom.noPageEvent.length;i<len;i++){var item=custom.noPageEvent[i];if(-1<url.indexOf(item)){res=!0;break}}else-1<url.indexOf("/html/video/iframe/")?res=!0:-1<url.indexOf("/p/video/app/embed/iframe/")&&(res=!0);return res}(meta,props.custom))log("no page call for:",meta.page.url);else{var info,data=-1<["amp","fbia"].indexOf(view)?PageInfo({type:"token",view:view,meta:meta,custom:props.custom}):PageInfo({type:"default",pageOnly:!0,custom:props.custom});if(log("values:",(info={segment:{name:data.name,properties:data.properties,options:data.options}},data.category&&(info.segment.category=data.category),info)),data.name&&data.properties&&data.options){var args=[data.name,data.properties,data.options,function(){resolve({type:"page",data:data})}];data.category&&args.unshift(data.category),window.analytics.page.apply(window.analytics.page,args)}else log("page call did not fire. missing required values!"),resolve({type:"page",error:!0,data:data})}})}}}),void 0!==Modulr?Modulr.define("leap.metrics:core/providers/segment/track.map",["require","core/config","core/helper"],TrackMap):"undefined"!=typeof module&&module.exports&&(module.exports=TrackMap()),Modulr.define("leap.metrics:core/providers/segment/track",["require","lodash","core/config","@PageInfo","core/utils/log","core/utils/promise","core/providers/segment/track.map"],function(require,_,config,PageInfo){var log=require("core/utils/log")("segment.page.track"),Map=require("core/providers/segment/track.map"),PromiseUtil=require("core/utils/promise");return new function(){this.trigger=function(data){return new PromiseUtil(function(resolve,reject){var props=data.props,pageInfo=(props.meta,PageInfo()),trackData=Map.get(props.name,data);if(trackData.error)done();else{var properties=_.cloneDeep(pageInfo.properties),options=_.cloneDeep(pageInfo.options);_.merge(properties,trackData.options||{}),log("values:",{siteId:props.siteId,error:!!trackData.error,segment:{event:trackData.event||trackData.eventId,properties:properties,options:options}}),window.analytics.track(trackData.event,properties,options,function(){done()})}function done(data){resolve({type:"track",data:trackData})}})}}}),Modulr.define("leap.metrics:core/utils/cookie",["require"],function(require){return function(name,value,options){if(void 0===value){var cookieValue=null;if(document.cookie&&""!==document.cookie)for(var cookies=document.cookie.split(";"),i=0;i<cookies.length;i++){var cookie=(cookies[i]||"").replace(/^\s+|\s+$/g,"");if(cookie.substring(0,name.length+1)===name+"="){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break}}return cookieValue}options=options||{},null===value&&(value="",options.expires=-1);var date,expires="";options.expires&&("number"==typeof options.expires||options.expires.toUTCString)&&("number"==typeof options.expires?(date=new Date).setTime(date.getTime()+24*options.expires*60*60*1e3):date=options.expires,expires="; expires="+date.toUTCString());var path=options.path?"; path="+options.path:"",domain=options.domain?"; domain="+options.domain:"",secure=options.secure?"; secure":"";return document.cookie=[name,"=",encodeURIComponent(value),expires,path,domain,secure].join(""),""}}),Modulr.define("leap.metrics:core/utils/datetime",["require"],function(require){return ordinalSuffix=function(n){if((n=(n||"").toString()).length<1)return n;var s="",num=parseInt(n,10),tens=99<num?parseInt(n.slice(n.length-2),10):num<20&&num;if(11<=tens&&tens<20)s="th";else switch(parseInt(n.charAt(n.length-1),10)){case 1:s="st";break;case 2:s="nd";break;case 3:s="rd";break;default:s="th"}return n+s},romanNumerals=function(n){n=parseInt(n,10);var i,numerals=[["M",1e3],["CM",900],["D",500],["CD",400],["C",100],["XC",90],["L",50],["XL",40],["X",10],["IX",9],["V",5],["IV",4],["I",1]],arr=[];for(i=0;i<numerals.length;i++)for(var item=numerals[i],rn=item[0],val=item[1];val<=n;)arr.push(rn),n-=val;return arr.join("")},getDayString=function(n,type){var ret=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][n];return"short"===type&&(ret=ret.slice(0,3)),ret},getUTCMonthString=function(n,type){var ret=["January","February","March","April","May","June","July","August","September","October","November","December"][n]||"";return"short"===type&&(ret=ret.slice(0,3)),ret},prefixZero=function(val){return val<10?"0"+toStr(val):val},toStr=function(val){return(val=isNaN(val)?"":val).toString()},function(date,formatStr){var obj={month:date.getUTCMonth(),day:date.getDay(),year:date.getFullYear(),date:date.getDate(),hour:date.getHours(),minutes:date.getMinutes(),seconds:date.getSeconds(),ampm:date.getHours()<12?"am":"pm",fullStr:date.toString()},replace=[["%m",obj.month<9?"0"+(obj.month+1):obj.month+1],["%M:s",getUTCMonthString(obj.month,"short")],["%M",getUTCMonthString(obj.month)],["%d:o",ordinalSuffix(obj.date)],["%d",obj.date<10?"0"+toStr(obj.date):toStr(obj.date)],["%D:s",getDayString(obj.day,"short")],["%D",getDayString(obj.day)],["%Y:r",romanNumerals(obj.year)],["%Y",obj.year],["%y",toStr(obj.year).substr(2)],["%h",prefixZero(12<obj.hour?obj.hour-12:obj.hour)],["%H",prefixZero(obj.hour)],["%i",prefixZero(obj.minutes)],["%s",prefixZero(obj.seconds)],["%ampm",obj.ampm],["%AMPM",obj.ampm.toUpperCase()],["%AmPm",obj.ampm.charAt(0).toUpperCase()+obj.ampm.charAt(1)]];if("string"==typeof formatStr&&formatStr)for(var i=0;i<replace.length;i++){var item=replace[i],fmt=item[0],val=item[1],re=new RegExp(fmt,"g");formatStr=formatStr.replace(re,val)}else formatStr=obj.fullStr;return formatStr};var ordinalSuffix,romanNumerals,getDayString,getUTCMonthString,prefixZero,toStr}),Modulr.define("leap.metrics:core/utils/eu",["require","core/config","core/utils/load.attempt","core/utils/query.param","core/utils/log","akamai.geo"],function(require,config,LoadAttempt,QueryParam){require("core/utils/log")("EU");var codes=["AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","DE","GR","HU","IE","IT","LV","LT","LU","MT","NL","PL","PT","RO","SK","SI","ES","SE","GB"];return new function(){var Proto=this,EU_OVERRIDE=-1<window.location.search.indexOf("_akovr=1");function isEU(){var info=FNC.GEO.geo.get(),code=QueryParam.getVal("_akgeo_code")||info.countryCode||null,cont=QueryParam.getVal("_akgeo_cont")||info.continent||null;return!!EU_OVERRIDE||"EU"===cont&&-1<codes.indexOf(code)}Proto.enabled=function(){return!0},Proto.check=function(callback){if("function"!=typeof callback)return isEU();callback(isEU())},Proto.allowProvider=function(provider){return!Proto.check()||!!function(provider){return"string"==typeof provider&&-1<config.EU_List.indexOf(provider)}(provider)}}}),Modulr.define("leap.metrics:core/utils/load.attempt",["require"],function(require){return window,CONST_attempts=999,CONST_timeout=500,fn=function(){},isNum=function(val){return"number"==typeof val},isFunc=function(val){return"function"==typeof val},function(){var args=arguments,cfg=!1;isNum(args[0])&&isNum(args[1])&&isFunc(args[2])?cfg={attempts:args[0],timeout:args[1],check:args[2],success:isFunc(args[3])?args[3]:fn,expires:isFunc(args[4])?args[4]:fn}:isNum(args[0])&&isFunc(args[1])?cfg={attempts:args[0],timeout:CONST_timeout,check:args[1],success:isFunc(args[2])?args[2]:fn,expires:isFunc(args[3])?args[3]:fn}:isFunc(args[0])&&(cfg={attempts:CONST_attempts,timeout:CONST_timeout,check:args[0],success:isFunc(args[1])?args[1]:fn,expires:isFunc(args[2])?args[2]:fn});var timeout,isAbort=!1,isExpires=!1,isSuccess=!1,attempt=function(){isAbort?(clearTimeout(timeout),isExpires="aborted",cfg.expires(isExpires)):cfg.check()?(isSuccess=!0,cfg.success(),clearTimeout(timeout)):0<cfg.attempts?timeout=setTimeout(function(){attempt()},cfg.timeout):(isExpires="expired",cfg.expires(isExpires)),cfg.attempts--};return attempt(),{abort:function(){isAbort=!0},success:function(success){isSuccess?success():cfg.success=success},expires:function(expires){isExpires?expires(isExpires):cfg.expires=expires}}};var CONST_attempts,CONST_timeout,fn,isNum,isFunc}),Modulr.define("leap.metrics:core/utils/log",["require","core/utils/cookie"],function(require,Cookie){var _PREFIX="[LeapMetrics]";return function(addPrefix,force){addPrefix=addPrefix?" '"+addPrefix.replace(/^\s+|\s$/g,"")+"'":"";var prefix=[_PREFIX,addPrefix].join("")+" >>",allow=function(){if(force)return!0;if(-1<window.location.search.indexOf("_leap=0"))return Cookie("_leap",null),!1;var res=-1<window.location.search.indexOf("_leap=1");return res?Cookie("_leap","y",{path:"/",expires:null}):"y"===Cookie("_leap")&&(res=!0),res}();return function(){if(!allow)return!1;var args=Array.prototype.slice.call(arguments);if(args=[prefix].concat(args),allow&&window.console)try{return window.console.log.apply(console,args)}catch(err){}}}}),Modulr.define("leap.metrics:core/utils/meta",["require","jquery","core/helper","core/utils/log"],function(require,$,Helper){require("core/utils/log")("core.utils.meta");var announce=require("core/utils/log")(null,!0);return new function(){var Proto=this,PAGE_META={},SITE_ID=null,GENERATED=!1;Proto.setSiteId=function(id){if(id)return SITE_ID?announce("[warn] SiteId can only be set once. [current:"+SITE_ID+" | attempt:"+id+")"):void(SITE_ID=id)},Proto.getSiteId=function(){if(!SITE_ID){var meta=Proto.get();Proto.setSiteId(meta.page.siteId)}return SITE_ID},Proto.get=function(force){return GENERATED&&!force?PAGE_META:(GENERATED=!0,loc=window.location,opengraph={},twitter={},info={},$("head > meta").each(function(){var el=$(this),name=el.attr("name")||el.attr("property")||null;if(name){var val=el.attr("content")||"";/^og\:/.test(name)&&(opengraph[name.replace(/^og\:/,"")]=val),/^twitter\:/.test(name)&&(twitter[name.replace(/^twitter\:/,"")]=val),info[name]=val}}),info.canonical=$('head > link[rel="canonical"]').attr("href")||"",meta=info,page=function(){var val,pagetype,allow,path,res,info={},host=loc.host,channel=((val=meta["prism.channel"]||"")||(val=/foxnews\.com$/.test(host)?"fnc":/foxbusiness\.com$/.test(host)?"fbn":"other"),val),section=function(val){return val||(/radio\.foxnews/.test(host)?val="radio":/insider\.foxnews/.test(host)?val="insider":/nation\.foxnews/.test(host)&&(val="nation")),val}(meta["prism.section"]||"");return info.title=meta["og:title"]||$("head > title:first").text(),info.url=loc.protocol+"//"+host+loc.pathname,info.path=loc.pathname,info.siteId=SITE_ID||function(path){var res=channel;switch(path){case"fnc/radio":res="radio";break;case"fnc/insider":res="insider";break;case"fnc/nation":res="nation"}return res=res||"other"}([channel,section].join("/")),info.type=(pagetype=meta.pagetype||meta.pageType||null,res="other",pagetype?res=/^home/i.test(pagetype)?"homepage":pagetype:"video"===section?res=/^\/playlist/.test(loc.pathname)?"playlist":"video":"radio"===info.siteId?"/"===loc.pathname&&(res="homepage"):"insider"===info.siteId&&("/"===loc.pathname?res="homepage":"article"===meta["og:type"]&&(res="article")),allow="radio"===info.siteId,path=info.path,allow&&(/^\/([0-9]{4})\/([0-9]{1,2})\/([0-9]{1,2})/.test(path)?res="article":/^\/([a-z0-9]+)/.test(path)&&(res="category")),res),info}(),PAGE_META={raw:meta,page:page,opengraph:opengraph,twitter:twitter});var info,loc,opengraph,twitter,meta,page}}}),Modulr.define("leap.metrics:core/utils/promise.iterator",["require"],function(require){return function(target,next,done){var list=[],type=null;if(Array.isArray(target))type="array",list=target;else{if("object"!=typeof target)return console.log("promiseIterator(error): target is not iterable"),done();type="object",function(){for(var id in target)list.push({id:id,data:target[id]})}()}if("function"!=typeof next)return console.log("promiseIterator(error): missing next()"),done();var iter=0,len=list.length;function fin(){"function"==typeof done&&done()}!function trigger(){if(iter<len){var item="object"===type?list[iter].data:list[iter];next(item,"object"===type?list[iter].id:iter,function(){iter++,trigger()},function(){fin()})}else fin()}()}}),Modulr.define("leap.metrics:core/utils/promise",["require"],function(require){return function(sender){var RESOLVE_STACK=[],REJECT_STACK=[],ARGS_DATA={};this.then=this.resolve=function(callback){return"function"==typeof callback&&(ARGS_DATA.resolve?callback.apply(callback,ARGS_DATA.resolve):RESOLVE_STACK.push(callback)),this},this.reject=function(callback){return"function"==typeof callback&&(ARGS_DATA.reject?callback.apply(callback,ARGS_DATA.reject):REJECT_STACK.push(callback)),this},sender(function(){if(ARGS_DATA.resolve=Array.prototype.slice.call(arguments),0<RESOLVE_STACK.length)for(;0<RESOLVE_STACK.length;){var fn=RESOLVE_STACK.shift();fn.apply(fn,ARGS_DATA.resolve)}},function(){if(ARGS_DATA.reject=Array.prototype.slice.call(arguments),0<REJECT_STACK.length)for(;0<REJECT_STACK.length;){var fn=REJECT_STACK.shift();fn.apply(fn,ARGS_DATA.reject)}})}}),Modulr.define("leap.metrics:core/utils/query.param",["require"],function(require){return new function(){var Proto=this;Proto.getVal=function(name){var queryObj=Proto.getAll();return!(!queryObj||!queryObj[name])&&decodeURIComponent(queryObj[name])},Proto.getAll=function(){for(var ret={},vals=(window.location.search.substr(1)||"").split("&"),x=0;x<vals.length;x++){var sp=vals[x].split("="),name=sp[0]||!1,value=sp.slice(1);value=1<value.length?value.join("="):sp[1]||!1,name&&value&&(ret[name]=decodeURIComponent(value).toString())}return ret},Proto.setToString=function(queryObj){var ret=[];for(var i in queryObj)ret.push(i+"="+queryObj[i]);return ret=ret.join("&")}}}),Modulr.define("leap.metrics:core/utils/script.loader",["require"],function(require){return function(src,callback,attr){"function"!=typeof callback&&(callback=function(){});var script=document.createElement("script");if(script.type="text/javascript",script.charset="utf-8",script.async=!0,attr&&"object"==typeof attr)for(var key in attr)script.setAttribute(key,attr[key]);!script.attachEvent||script.attachEvent.toString&&script.attachEvent.toString().indexOf("[native code")<0||isOpera?(script.addEventListener("load",callback,!1),script.addEventListener("error",function(){throw new Error("Error loading script: "+src)},!1)):script.attachEvent("onreadystatechange",callback),script.src=src,document.getElementsByTagName("head")[0].appendChild(script)}}),Modulr.define("leap.metrics:core/utils/session.storage",["require"],function(require){return new function(){var Proto=this;function storagePrefix(id){return"leap_sessstore__"+id}Proto.isAvailable=function(){var res=!0,testId="__coretest_sessionStorage";if("object"==typeof window.sessionStorage)try{window.sessionStorage.setItem(testId,1),window.sessionStorage.removeItem(testId)}catch(err){res=!1}return res},Proto.set=function(id,val){Proto.isAvailable()&&("string"!=typeof val&&(val="object"==typeof val?JSON.stringify(val):void 0!==val?val.toString():null),null!==val&&window.sessionStorage.setItem(storagePrefix(id),val))},Proto.get=function(id){if(!Proto.isAvailable())return null;try{return window.sessionStorage.getItem(storagePrefix(id))}catch(err){return null}},Proto.remove=function(id){if(Proto.isAvailable())try{window.sessionStorage.removeItem(storagePrefix(id))}catch(err){}}}})}(),function(){var Proto=this,CORE_API=null;Proto.load=function(){var args=arguments,scripts="string"==typeof args[0]?[args[0]]:Array.isArray(args[0])?args[0]:[],callback="function"==typeof args[0]?args[0]:args[1]&&"function"==typeof args[1]?args[1]:function(){};Instance.require(["require"],function(require){var runCallback=function(){"function"==typeof callback&&callback(require)};if(0<scripts.length){var loader=function(){var src=scripts.shift();Modulr.loadScript(src,function(){0<scripts.length?loader():runCallback()})};loader()}else runCallback()})},Proto.execute=function(item){function trigger(attrs,callback){Proto.load(function(require){require(["core/utils/eu"],function(){require("core/utils/eu").allowProvider("segment")||(attrs.disabled=!0),CORE_API?callback(CORE_API,require):require(["core/api"],function(API){CORE_API||(CORE_API=new API(attrs)),callback(CORE_API,require)})})})}"function"==typeof item?trigger({},item):"object"!=typeof item||Array.isArray(item)||"function"==typeof item.callback&&trigger(item.attrs||{},item.callback)}}}())}((window,function(){var MODULR_STACK={},MODULR_STACK_QUEUE={},LOADED_SCRIPTS={},LOADED_SCRIPTS_QUEUE={},LOADED_INSTANCE_INCLUDES={},LOADED_INSTANCE_INCLUDES_STACK_QUEUE={},INSTANCE_LIST={},MASTER_FILE=[],MASTER_FILE_LOADED=[],SHIM_QUEUE={},ON_READY=!1,READY_QUEUE=[],EXECUTE_LISTENER=null,GLOBAL_CACHE_PARAM_VAR=null,GLOBAL_CACHE_PARAM_COND=[],LOG_PREFIX="[Modulr]",executeReadyState=function(){var trigger=function(){for(ON_READY=!0;0<READY_QUEUE.length;)READY_QUEUE.shift()()};EXECUTE_LISTENER?EXECUTE_LISTENER(trigger):trigger()};!function(done){if(window.addEventListener)window.addEventListener("load",done,!1);else if(window.attachEvent)window.attachEvent("onload",done);else{var prev=window.onload;window.onload=function(){prev(),done()}}}(function(){ON_READY||executeReadyState()});var isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),readyRegExp=/^(complete|loaded)$/,Modulr=function(CONFIG){(CONFIG=CONFIG||{}).context=CONFIG.instance||CONFIG.context||"_",CONFIG.wait="boolean"!=typeof CONFIG.wait||CONFIG.wait;var id,invalid,CONTEXT=CONFIG.context;if(invalid=/[^A-Za-z0-9_\-\.]/g.test(id=CONTEXT),("string"!=typeof id||invalid)&&throwError("invalid context:",CONTEXT),MODULR_STACK[CONTEXT])return log("WARNING: attempt to instantiate the same context:",CONTEXT,"\n. No configuration changes, returning instance instead.."),MODULR_STACK[CONTEXT].instance;MODULR_STACK[CONTEXT]={instance:this,stack:{}};var STACK=MODULR_STACK[CONTEXT].stack,INSTANCE_INIT=!1,Proto=this;function processDepsPath(deps){if(CONFIG.paths)for(var i in CONFIG.paths)deps=deps.replace(i,CONFIG.paths[i]);return deps.replace(/\/\//g,"/").replace(/^\//,"")}Proto.version="2.0.1",Proto.getConfig=function(){return CONFIG},Proto.getInstance=function(context){return MODULR_STACK[context]?MODULR_STACK[context].instance:null},Proto.setExecuteListener=function(callback){EXECUTE_LISTENER||"function"!=typeof callback||(EXECUTE_LISTENER=callback)},Proto.getLoadedScripts=function(){var scripts={};for(var item in LOADED_SCRIPTS){var sp=item.split("||"),context=sp[0],url=sp[1]||"";context&&url&&(scripts[context]||(scripts[context]=[]),scripts[context].push(url))}return scripts},Proto.define=function(id,deps,factory){(function(id){var str="string"==typeof id?id.replace(/\s+/gi,""):"";return 0<str.length&&"require"!==str&&"define"!==str&&"exports"!==str})(id)||throwError("invalid id:",id),2!==arguments.length||isArray(deps)||(factory=deps,deps=[]);var ext=isExtendedInstance(id=processDepsPath(id));ext?MODULR_STACK[ext.context]?MODULR_STACK[ext.context].instance.define(ext.id,deps,factory):(MODULR_STACK_QUEUE[ext.context]||(MODULR_STACK_QUEUE[ext.context]=[]),MODULR_STACK_QUEUE[ext.context].push({ext:ext,deps:deps,factory:factory})):STACK[id]||(deps=deps||[],STACK[id]={executed:!1,exports:{},deps:deps,factory:factory})},Proto.require=function(deps,callback){return"string"==typeof deps?(stack=null,type="module",(ext=isExtendedInstance(id=processDepsPath(id=deps)))?"module"===ext.type?stack=MODULR_STACK[ext.context].stack[ext.id]:"instance"===ext.type&&(stack=MODULR_STACK[ext.context].instance,type="instance"):stack=STACK[id],"module"===type&&(stack&&!stack.executed&&throwError("module not yet executed:",id),stack=stack?void 0!==stack.factory?stack.factory:stack.exports:null),stack):isArray(deps)?new UtilPromise(function(resolve){var getDeps=function(){MODULE.get(null,deps,function(args){"function"==typeof callback?getFactory(callback,args):resolve.apply(resolve,args)})},trigger=function(){INSTANCE_INIT?getDeps():(INSTANCE_INIT=!0,CONFIG.baseDomain=addProtocol(CONFIG.baseDomain)||getDomain(),CONFIG.baseUrl=CONFIG.baseUrl||getRelativePath(),function(callback){if(CONFIG.masterFile){var src=setPathSrc(CONFIG.masterFile);-1<MASTER_FILE_LOADED.indexOf(src)?callback():-1===MASTER_FILE.indexOf(src)?(MASTER_FILE.push(src),loadScript(src,null,function(){MASTER_FILE_LOADED.push(src),callback()})):callback()}else callback()}(function(){loadPackages(CONFIG.packages,function(){getDeps()})}))};CONFIG.wait?ON_READY?trigger():READY_QUEUE.push(trigger):trigger()}):void 0;var id,stack,type,ext},Proto.config=function(config){if(config.context||config.instance){for(var instance=new Modulr(config),remove=["config","getInstance","loadPackageList","setGlobalCacheParam","setGlobalCacheCond","setExecuteListener"],i=0;i<remove.length;i++){var id=remove[i];instance[id]&&delete instance[id]}return instance.loadPackage=function(packages,callback){"function"!=typeof callback&&throwError("loadPackage() requires a callback!"),isArray(packages)||"object"!=typeof packages?throwError("cannot load package list."):loadPackages(packages,callback.apply(callback,Proto.require))},instance}if(INSTANCE_INIT)return log('WARNING: Instance "'+config.instance+'" already exists! no configuration changes, returning instance instead..'),Proto.getInstance(config.instance);CONFIG=config},Proto.execModule=function(id,callback){var module=getStack(id);if("function"!=typeof callback)return!1;module?module.executed?callback(MODULE.getModuleFactory(module)):MODULE.execModule(null,null,id,function(factory){callback(factory)}):callback(null)},Proto.loadPackageList=function(packages){if(isArray(packages)||"object"!=typeof packages)throwError("cannot load package list.");else for(var id in packages)INSTANCE_LIST[id]||(INSTANCE_LIST[id]=packages[id])},Proto.setGlobalCacheParam=function(val){"string"!=typeof val&&"number"!=typeof val||(GLOBAL_CACHE_PARAM_VAR=val)},Proto.setGlobalCacheCond=function(list){Array.isArray(list)&&(GLOBAL_CACHE_PARAM_COND=GLOBAL_CACHE_PARAM_COND.concat(list))},Proto.getGlobalCacheParam=function(){return GLOBAL_CACHE_PARAM_VAR},Proto.getPackageListInfo=function(){return{master:MASTER_FILE,instances:INSTANCE_LIST}},Proto.setReady=function(){executeReadyState()},Proto.loadScript=function(src,callback){loadScript(src,null,function(){"function"==typeof callback&&callback()})},function(){if(MODULR_STACK_QUEUE[CONTEXT])for(var instance=MODULR_STACK[CONTEXT].instance;0<MODULR_STACK_QUEUE[CONTEXT].length;){var item=MODULR_STACK_QUEUE[CONTEXT].shift();instance.define(item.ext.id,item.deps,item.factory)}}(),function(){if(CONFIG.shim){var arr=[];for(var sid in CONFIG.shim)arr.push({id:sid,info:CONFIG.shim[sid]});for(var setDefinition=function(obj){var id=obj.id,info=obj.info,deps=(setPathSrc(info.src),info.deps||[]);Proto.define(id,deps,function(){return getShimExport(info.exports)})};0<arr.length;)setDefinition(arr.shift())}}();var MODULE=new function(){var self=this;self.get=function(moduleId,deps,callback){var arr,args=[];deps?arr=cloneArr(deps):moduleId&&STACK[moduleId]&&(arr=cloneArr(STACK[moduleId].deps));var getDeps=function(){if(0===arr.length)callback(args);else{var id=processDepsPath(arr.shift()),module=getStack(id),ext=isExtendedInstance(id);if(ext)"module"===ext.type?function(id,callback){var sp=id.split(":"),context=sp[0]||!1,moduleId=sp[1]||!1;if(context&&moduleId&&MODULR_STACK[context]){var instance=MODULR_STACK[context].instance;MODULR_STACK[context].stack[moduleId]?instance.execModule(moduleId,function(factory){callback(factory)}):instance.require([moduleId],function(){instance.execModule(moduleId,function(factory){callback(factory)})})}else log(["Not initialized >> CONTEXT:",context,"| module:",moduleId].join(" ")),callback(null)}(id,function(extFactory){args.push(void 0!==extFactory?extFactory:null),getDeps()}):"instance"===ext.type&&(args.push(function(context){if(MODULR_STACK[context])return MODULR_STACK[context].instance;throwError("Error getting instance:",context)}(ext.context)),getDeps());else if("require"===id)args.push(Proto.require),getDeps();else if("define"===id)args.push(Proto.define),getDeps();else if("exports"===id)args.push(STACK[moduleId].exports),getDeps();else if(module&&!isShimModuleId(id))module.executed?(args.push(self.getModuleFactory(module)),getDeps()):self.execModule(null,null,id,function(factory){args.push(factory),getDeps()});else if(isShimModuleId(id)){var shimInfo=CONFIG.shim[id];self.loadShim(id,shimInfo,function(factory){args.push(factory),getDeps()})}else{var src=self.getModulePath(id);loadScript(src,id,function(){self.execModule("load",src,id,function(factory){args.push(factory),getDeps()})})}}};getDeps()},self.loadShim=function(id,info,callback){var src=setPathSrc(info.src),module=getStack(id);isExportsDefined(info.exports)?(module.executed=!0,module.factory=getShimExport(info.exports),callback(module.factory)):SHIM_QUEUE[src]?SHIM_QUEUE[src].push(function(){self.execModule("shim",null,id,function(factory){callback(factory)})}):(SHIM_QUEUE[src]=[function(){self.execModule("shim",null,id,function(factory){callback(factory)})}],loadScript(src,id,function(){isExportsDefined(info.exports)?function(id){if(SHIM_QUEUE[id])for(;0<SHIM_QUEUE[id].length;)SHIM_QUEUE[id].shift()()}(src):throwError("shim export not found for:",id)},null,{noCacheString:info.noCacheString||null,noStore:info.noStore||null,queryParam:info.queryParam||null}))},self.execModule=function(type,src,id,callback){var module=getStack(id);module?module.executed?callback(self.getModuleFactory(module)):(self._execQueue||(self._execQueue={}),self._execQueue[id]||(self._execQueue[id]=[]),module.executing?self._execQueue[id].push(callback):(module.executing=!0,self._execQueue[id].push(callback),self.get(id,module.deps,function(args){module.factory=getFactory(module.factory,args),module.executed=!0,module.executing=!1,self.runCallbackQueue(id,self.getModuleFactory(module))}))):(log("loading external source:",src),callback({id:id,src:src,type:"external-script"}))},self.runCallbackQueue=function(id,factory){for(var queue=self._execQueue[id]||[];0<queue.length;)queue.shift()(factory)},self.getModuleFactory=function(module){return null!==module.factory?module.factory:module.exports},self.getModulePath=function(id){var path;return path=id,[rtrimSlash([rtrimSlash(CONFIG.baseDomain||getDomain()),ltrimSlash(CONFIG.baseUrl||getRelativePath())].join("/")),path=rtrimSlash(ltrimSlash(path))].join("/")+".js"}};function getStack(id){return STACK[id]||!1}function isExtendedInstance(id){var ret=!1;if(-1<id.indexOf(":")){var sp=id.split(":"),context=sp[0]||!1,moduleId=sp[1]||!1;"getInstance"===context&&moduleId?ret={type:"instance",context:moduleId}:context&&moduleId&&(ret={type:"module",context:context,id:moduleId})}return ret}function loadPackages(packages,callback){if(packages){var arr=[],setPackageObj=function(obj){for(var uid in obj)INSTANCE_LIST[uid]||(INSTANCE_LIST[uid]=obj[uid]),arr.push({uid:uid,src:obj[uid]})};if(isArray(packages))for(var i=0;i<packages.length;i++){var item=packages[i];"string"==typeof item&&INSTANCE_LIST[item]?arr.push({uid:item,src:INSTANCE_LIST[item]}):"object"!=typeof item||isArray(item)?throwError("cannot find package named:",item):setPackageObj(item)}else setPackageObj(packages);var getInstance=function(){if(0===arr.length)callback();else{var obj=arr.shift(),uid=obj.uid,src=setPathSrc(obj.src);MODULR_STACK[uid]?getInstance():LOADED_INSTANCE_INCLUDES[src]?(LOADED_INSTANCE_INCLUDES_STACK_QUEUE[src]||(LOADED_INSTANCE_INCLUDES_STACK_QUEUE[src]=[]),LOADED_INSTANCE_INCLUDES_STACK_QUEUE[src].push(function(){getInstance()})):(LOADED_INSTANCE_INCLUDES[src]=uid,loadScript(src,uid,function(){getInstance(),LOADED_INSTANCE_INCLUDES_STACK_QUEUE[src]&&function(srcId){for(var queue=LOADED_INSTANCE_INCLUDES_STACK_QUEUE[srcId];0<queue.length;)queue.shift()();delete LOADED_INSTANCE_INCLUDES_STACK_QUEUE[srcId]}(src)},"instance"))}};getInstance()}else callback()}function setPathSrc(src){var ret=src;return 0!==src.indexOf("http")&&(ret=0===src.indexOf("//")?addProtocol(src):CONFIG.baseDomain+("/"!==src.charAt(0)?"/":"")+src),ret}function isShimModuleId(id){return!(!CONFIG.shim||!CONFIG.shim[id])}function getShimExport(scope){return window[scope.split(".")[0]]}function loadScript(src,id,callback,specType,cacheInfo){cacheInfo=cacheInfo||{};var loaded=!1,script=document.createElement("script"),scriptId=[CONTEXT||"",src].join("||"),noBrowserCache=cacheInfo.noCacheString||null,customCacheCond=function(src){for(var list=GLOBAL_CACHE_PARAM_COND,res=null,i=0;i<list.length;i++){var item=list[i];if("object"==typeof item&&item.regex instanceof RegExp&&item.regex.test(src)){res=item;break}}return res}(src),noStore=!(!customCacheCond||!0!==customCacheCond.noStore)||(!0===noBrowserCache?null:cacheInfo.noStore),queryParam=customCacheCond&&"string"==typeof customCacheCond.param?customCacheCond.param:cacheInfo.queryParam,onLoad=function(evt){if(!loaded&&"load"===evt.type||readyRegExp.test((evt.currentTarget||evt.srcElement).readyState)){for(loaded=!0;0<LOADED_SCRIPTS_QUEUE[scriptId].length;)LOADED_SCRIPTS_QUEUE[scriptId].shift()();delete LOADED_SCRIPTS_QUEUE[scriptId],removeScriptListener()}},onError=function(){throwError("error loading script:",src)},removeScriptListener=function(){removeListener(script,onLoad,"load","onreadystatechange"),removeListener(script,onError,"error")};if(id){var idAttrName="data-modulr-module";specType&&(idAttrName="data-modulr-loaded-inst"),script.setAttribute(idAttrName,id)}if(script.setAttribute("data-modulr-context",CONTEXT),LOADED_SCRIPTS[scriptId])return LOADED_SCRIPTS_QUEUE[scriptId].push(function(){callback(id)}),!1;LOADED_SCRIPTS[scriptId]=!0,LOADED_SCRIPTS_QUEUE[scriptId]=[function(){callback(id)}],script.type="text/javascript",script.charset="utf-8",script.async=!0,!script.attachEvent||script.attachEvent.toString&&script.attachEvent.toString().indexOf("[native code")<0||isOpera?(script.addEventListener("load",onLoad,!1),script.addEventListener("error",onError,!1)):script.attachEvent("onreadystatechange",onLoad),script.src=function(src){var ret=src;if(customCacheCond&&noStore&&queryParam)ret=src+(-1<src.indexOf("?")?"&":"?")+(queryParam?queryParam+"=":"")+(new Date).getTime();else if((CONFIG&&CONFIG.cacheParam||GLOBAL_CACHE_PARAM_VAR)&&!noBrowserCache){var param=queryParam||("string"==typeof CONFIG.cacheParam?CONFIG.cacheParam:GLOBAL_CACHE_PARAM_VAR?"v":""),cb=function(){var res;if(noStore)res=(new Date).getTime();else if(GLOBAL_CACHE_PARAM_VAR)res=GLOBAL_CACHE_PARAM_VAR;else{var c=new Date,secs=c.getSeconds();res=[c.getFullYear(),c.getMonth()+1,c.getDate(),c.getHours(),c.getMinutes()].join("")+(secs<=30?30:1)}return res}();ret=src+(-1<src.indexOf("?")?"&":"?")+(param?param+"=":"")+cb}return ret}(src),document.getElementsByTagName("head")[0].appendChild(script)}};function getFactory(factory,deps){return"function"==typeof factory?factory.apply(factory,deps):factory}function isExportsDefined(exports){var ex=exports.split("."),tmp=window[ex.shift()],ret=!1;if(void 0!==tmp&&(ret=!0,0<ex.length))for(;0<ex.length;)if(void 0===(tmp=tmp[ex.shift()])){ret=!1;break}return ret}function getRelativePath(){var path=window.location.pathname.split("/");return path.pop(),path=path.join("/")+"/",getDomain()+path}function getDomain(){var loc=window.location;return loc.protocol+"//"+(loc.host||loc.hostname)}function addProtocol(domain){var ret=domain,protocol=window.location.protocol;return 0!==domain.indexOf("http")&&(ret=protocol+(0!==domain.indexOf("//")?"//":"")+domain),ret}function cloneArr(arr){for(var ret=[],i=0;i<arr.length;i++)ret.push(arr[i]);return ret}function removeListener(node,func,name,ieName){node.detachEvent&&!isOpera?ieName&&node.detachEvent(ieName,func):node.removeEventListener(name,func,!1)}function ltrimSlash(val){return"/"===val.charAt(0)?val.slice(1):val}function rtrimSlash(val){return"/"===val.charAt(val.length-1)?val.slice(0,val.length-1):val}function isArray(val){return val=val||!1,"[object Array]"===Object.prototype.toString.call(val)}function log(){var args=Array.prototype.slice.call(arguments);args.unshift(LOG_PREFIX);try{return window.console.log.apply(window.console,args)}catch(err){window.console.log(args.join(" | "))}}function throwError(){var args=Array.prototype.slice.call(arguments);throw args.unshift(LOG_PREFIX),new Error(args.join(" "))}function UtilPromise(sender){var _resolve=[],_reject=null;this.then=this.resolve=function(cb){return"function"==typeof cb&&_resolve.push(cb),this},this.reject=function(cb){"function"==typeof cb&&(_reject=cb)},sender(function(){if(_resolve)for(var args=Array.prototype.slice.call(arguments);0<_resolve.length;){var fn=_resolve.shift();data=fn.apply(fn,args)}},function(data){if(_reject){var args=Array.prototype.slice.call(arguments);_reject.apply(_reject,args)}})}return new Modulr}()),function(){var ready=!1,init=!1,stack=[],executeStack=function(){if(0!==stack.length)for(;0<stack.length;){stack.shift()()}};return function(callback){if("function"==typeof callback){if(ready)return callback();stack.push(callback),init||(init=!0,window.addEventListener?"complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?(ready=!0,executeStack()):document.addEventListener("DOMContentLoaded",executeStack):window.attachEvent&&document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",arguments.callee),ready=!0,executeStack())}))}}}()));